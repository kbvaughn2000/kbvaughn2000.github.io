<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Year of the Rabbit is an easy difficulty box on TryHackMe. Below are the steps taken to root the box.
First, I ran Threader3000 on this box and it returns 3 open ports.
Next, I ran nmap -A -p 21,22,80 to better enumerate these ports and gain more info on what is running.
Next, I visited the website to see what was present. The website pulled up the default web page for Apache2."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Year of the Rabbit - TryHackMe"><meta name=twitter:description content="Year of the Rabbit is an easy difficulty box on TryHackMe. Below are the steps taken to root the box.
First, I ran Threader3000 on this box and it returns 3 open ports.
Next, I ran nmap -A -p 21,22,80 to better enumerate these ports and gain more info on what is running.
Next, I visited the website to see what was present. The website pulled up the default web page for Apache2."><meta property="og:title" content="Year of the Rabbit - TryHackMe"><meta property="og:description" content="Year of the Rabbit is an easy difficulty box on TryHackMe. Below are the steps taken to root the box.
First, I ran Threader3000 on this box and it returns 3 open ports.
Next, I ran nmap -A -p 21,22,80 to better enumerate these ports and gain more info on what is running.
Next, I visited the website to see what was present. The website pulled up the default web page for Apache2."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-23-year-of-the-rabbit/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-23T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-23T00:00:00+00:00"><title>Year of the Rabbit - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-23-year-of-the-rabbit/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a2eeff1d223fbc3bb6ff964c9089232ebb9cc98ec98ad5e666e532eccccce7b6.css integrity="sha256-ou7/HSI/vDu2/5ZMkIkjLrucyY7JitXmZuUy7MzM57Y=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.111.1"></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-23-year-of-the-rabbit/>Year of the Rabbit - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-23T00:00:00Z>July 23, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/year-of-the-rabbit/>Year of the Rabbit</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/privilege-escalation/>privilege escalation</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/steganography/>steganography</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/website-enumeration/>website enumeration</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/cve/>CVE</a></span></div></div></header><div><p>Year of the Rabbit is an easy difficulty box on <a href=https://www.tryhackme.com>TryHackMe</a>. Below are the steps taken to root the box.</p><p>First, I ran Threader3000 on this box and it returns 3 open ports.</p><p><img src=/assets/img/YearOfTheRabbit1.png alt="Year of the Rabbit Threader3000"></p><p>Next, I ran <strong>nmap -A -p 21,22,80</strong> to better enumerate these ports and gain more info on what is running.</p><p><img src=/assets/img/YearOfTheRabbit2.png alt="Year of the Rabbit nmap"></p><p>Next, I visited the website to see what was present. The website pulled up the default web page for Apache2.</p><p><img src=/assets/img/YearOfTheRabbit3.png alt="Year of the Rabbit website"></p><p>Next, I ran <strong>gobuster dir -u http://[machine ip] -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 50</strong> to enumerate the website. Within a few moments, the <strong>/assets</strong> directory was uncovered.</p><p><img src=/assets/img/YearOfTheRabbit4.png alt="Year of the Rabbit gobuster"></p><p>Visiting this directory shows two files, RickRolled.mp4, which I assume was the Rick Astley &ldquo;Never Going to Give You Up&rdquo; video, and <strong>style.css</strong>.</p><p><img src=/assets/img/YearOfTheRabbit5.png alt="Year of the Rabbit assets directory"></p><p>The <strong>style.css</strong> page provides you with the next place you are supposed to take a look, <strong>/sup3r_s3cr3t_fl4g.php</strong></p><p><img src=/assets/img/YearOfTheRabbit6.png alt="Year of the Rabbit style.css"></p><p>Visiting the <strong>/sup3r_s3cr3t_fl4g.php</strong> page provides you with the following popup:</p><p><img src=/assets/img/YearOfTheRabbit7.png alt="Year of the Rabbit Sup3r_s3cr3t_fl4g.php"></p><p>You are then redirected to YouTube, which of course leads to the Rick Astley &ldquo;Never Going To Give You Up&rdquo; video. Let&rsquo;s disable JavaScript in our browser and revisit the <strong>/sup3r_s3cr3t_fl4g.php</strong> page. You are presented with another video you have to watch/listen to to get the next hint.</p><p><img src=/assets/img/YearOfTheRabbit8.png alt="Year of the Rabbit sup3r_s3cr3t_fl4g no JavaScript"></p><p>This once again plays Rick Astley&rsquo;s &ldquo;Never Going To Give You Up&rdquo; video. At this point I started Burp Suite to see if there was anything to intercept and revisited the <strong>/sup3r_s3cr3t_fl4g.php</strong> page again. We were able to find a request that appears to have a hidden directory in it.</p><p><img src=/assets/img/YearOfTheRabbit9.png alt="Year of the Rabbit Intermediary.php hidden directory"></p><p>copying and pasting this directory gives us another directory with an image in it.</p><p><img src=/assets/img/YearOfTheRabbit10.png alt="Year of the Rabbit hidden directory"></p><p>The picture does pull up, but it seems like a relatively large file size for such a small image. Let&rsquo;s see if there&rsquo;s anything hidden in it. Running <strong>exiftool Hot_Babe.png</strong> provides you with a warning that there is data after the PNG IEND chunk. This sounds like someone manually entered data into this image. Let&rsquo;s open it with <strong>nano Hot_Babe.png</strong>. At the very bottom of the image is a message with the FTP Username and potential passwords, one of which is correct.</p><p><img src=/assets/img/YearOfTheRabbit12.png alt="Year of the Rabbit Hot_Babe.png hidden ftp"></p><p>Let&rsquo;s copy all of the potential passwords and save them in a file named <strong>rabbit.txt</strong>. Next, run <strong>hydra -l [user from Hot_Babe.png] -P rabbit.txt [machine ip] ftp</strong> to brute force the ftp login credentials with hydra. Within a few moments you will have cracked the password.</p><p><img src=/assets/img/YearOfTheRabbit13.png alt="Year of the Rabbit hydra"></p><p>Next, login with <strong>ftp [machine ip]</strong> using the credentials that were just cracked with hydra. Next, run <strong>ls</strong> and <strong>get Eli&rsquo;s_Creds.txt</strong> to save the credential file.</p><p><img src=/assets/img/YearOfTheRabbit14.png alt="Year of the Rabbit Eli&amp;rsquo;s Creds"></p><p>Reviewing Eli&rsquo;s Credentials, it appears they are written in <strong>Brainfuck</strong>. Let&rsquo;s <a href=https://www.dcode.fr/brainfuck-language>decode</a> and see what we end up with.</p><p><img src=/assets/img/YearOfTheRabbit15.png alt="Year of the Rabbit Brainfuck decoded"></p><p>This provides us with, surprise surprise, Eli&rsquo;s credentials. Let&rsquo;s use them to try to login with <strong>ssh eli@[machine-ip]</strong> and enter the password you just uncovered.</p><p><img src=/assets/img/YearOfTheRabbit16.png alt="Year of the Rabbit ssh access"></p><p>This appears to be our next clue. Let&rsquo;s see if we can find a file with the name s3cr3t in it with <strong>find / -name &ldquo;s3cr3t&rdquo; 2>/dev/null</strong>. This returns one result, <strong>/usr/games/s3cr3t</strong>. Let&rsquo;s run <strong>cd /usr/games</strong> followed by <strong>ls</strong>, it shows you that <strong>s3cr3t</strong> is a directory. Let&rsquo;s run <strong>cd s3cr3t</strong> followed by another <strong>ls</strong> to view it&rsquo;s contents. There is a file named <strong>.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!</strong> present here.</p><p><img src=/assets/img/YearOfTheRabbit17.png alt="Year of the Rabbit s3cr3t directory"></p><p>Let&rsquo;s run <strong>cat .th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly\!</strong> to view it&rsquo;s contents. this will give us <strong>gwendoline&rsquo;s password</strong>.</p><p><img src=/assets/img/YearOfTheRabbit18.png alt="Year of the Rabbit gwendoline&amp;rsquo;s password"></p><p>Let&rsquo;s run <strong>su gwendoline</strong> and enter the password that was just uncovered and run <strong>cd ~</strong> to go to her home directory. Next, let&rsquo;s run <strong>ls</strong>, and we are able to get the user flag with <strong>cat user.txt</strong></p><p><img src=/assets/img/YearOfTheRabbit19.png alt="Year of the Rabbit user.txt"></p><p>Next, let&rsquo;s run <strong>sudo -l</strong> and see if gwendoline has any special privileges. It appears that she can run <strong>/usr/bin/vi /home/gwendoline/user.txt</strong>.</p><p><img src=/assets/img/YearOfTheRabbit20.png alt="Year of the Rabbit sudo -l"></p><p>It appears that gwendoline can open vi as any user except root, which doesn&rsquo;t do us much good, as we need to be able to use root to escalate privileges. At this point I turned to Google to see if there were any vulnerabilities with sudo, and here is where I learned about <strong>CVE-2019-14287</strong>, which is a vulnerability in some versions of sudo. Essentially, if you use a user ID of -1 or sudo, it doesn&rsquo;t know what to do, and reverts to user ID 0, which is root. Let&rsquo;s run <strong>sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt</strong> and see what happens.</p><p><img src=/assets/img/YearOfTheRabbit21.png alt="Year of the Rabbit vi as root"></p><p>Awesome, we were able to open vi, let&rsquo;s hit escape and enter <strong>!bin/sh</strong> and see who we get a shell as.</p><p><img src=/assets/img/YearOfTheRabbit22.png alt="Year of the Rabbit root shell"></p><p>We now have root access, now just run <strong>cd /root</strong> and <strong>cat root.txt</strong> to get the final flag for this box.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>