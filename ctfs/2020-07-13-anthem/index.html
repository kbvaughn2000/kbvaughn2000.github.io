<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Anthem is a beginner&rsquo;s Windows box on TryHackMe. Below is a detailed walkthrough of the steps to follow to attain the root flag on this box.
Task 1 The first step, as usual, is to run nmap with nmap -sC -sV -T4 [machine ip] after a few minutes, this will display what ports are open.
It appears that HTTP, SMB, and RDP are open. The port for HTTP is the answer for Question 2 (question 1 does not require an answer) and the port for Microsoft Terminal Services is the answer to Question 3."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content=" Anthem - TryHackMe"><meta name=twitter:description content="Anthem is a beginner&rsquo;s Windows box on TryHackMe. Below is a detailed walkthrough of the steps to follow to attain the root flag on this box.
Task 1 The first step, as usual, is to run nmap with nmap -sC -sV -T4 [machine ip] after a few minutes, this will display what ports are open.
It appears that HTTP, SMB, and RDP are open. The port for HTTP is the answer for Question 2 (question 1 does not require an answer) and the port for Microsoft Terminal Services is the answer to Question 3."><meta property="og:title" content=" Anthem - TryHackMe"><meta property="og:description" content="Anthem is a beginner&rsquo;s Windows box on TryHackMe. Below is a detailed walkthrough of the steps to follow to attain the root flag on this box.
Task 1 The first step, as usual, is to run nmap with nmap -sC -sV -T4 [machine ip] after a few minutes, this will display what ports are open.
It appears that HTTP, SMB, and RDP are open. The port for HTTP is the answer for Question 2 (question 1 does not require an answer) and the port for Microsoft Terminal Services is the answer to Question 3."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-13-anthem/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-13T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-13T00:00:00+00:00"><title>Anthem - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-13-anthem/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.708686f8ab8176e91d44fcbe488a0fe0333b94f405cf18a52383d67ba22f0ccb.css integrity="sha256-cIaG+KuBdukdRPy+SIoP4DM7lPQFzxilI4PWe6IvDMs=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.aa883b9ce35a8ff4a2a5008619005175e842bb18a8a9f9cc2bbcf44dab2d91fa.css integrity="sha256-qog7nONaj/SipQCGGQBRdehCuxioqfnMK7z0Tastkfo=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.100.1"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-13-anthem/>Anthem - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-13T00:00:00Z>July 13, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/anthem/>Anthem</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/website-research/>website research</a></span></div></div></header><div><p>Anthem is a beginner&rsquo;s Windows box on <a href=https://www.tryhackme.com>TryHackMe</a>. Below is a detailed walkthrough of the steps to follow to attain the root flag on this box.</p><h3 id=task-1>Task 1
<a class=heading-link href=#task-1><i class="fa fa-link" aria-hidden=true></i></a></h3><p>The first step, as usual, is to run nmap with <strong>nmap -sC -sV -T4 [machine ip]</strong> after a few minutes, this will display what ports are open.</p><p><img src=/assets/img/Anthem1.png alt="Anthem nmap"></p><p>It appears that HTTP, SMB, and RDP are open. The port for <strong>HTTP</strong> is the answer for <strong>Question 2</strong> (question 1 does not require an answer) and the port for <strong>Microsoft Terminal Services</strong> is the answer to <strong>Question 3</strong>. Let&rsquo;s start by visiting the website in our browser. It appears to be a blog of some sort.</p><p><img src=/assets/img/Anthem2.png alt="Anthem website home page"></p><p>This challenge said no brute force is required, and everything can be done via browser or RDP. Let&rsquo;s look at what the next few questions are asking for.</p><p><strong>Question 4</strong> gives a very big hint in the question itself, as it asks for a page web crawlers check for. The most common one is <strong>robots.txt</strong>, which is the answer to this question. Visiting that page at <strong>http://[machine ip]/robots.txt</strong> shows you a few directories that are disallowed, but the first line appears to be a potential password, which is the answer to this question.</p><p><img src=/assets/img/Anthem3.png alt="Anthem robots.txt"></p><p><strong>Question 5</strong> asks what the CMS is that is being used. In <strong>robots.txt</strong> there are some directories that have been disallowed that have been obfuscated above. This is the answer to that question.</p><p><strong>Question 6</strong> asks what the domain is. The main page, as shown near the top of this walkthrough, mentions <strong>Anthem.com</strong>, this successfully solves this question.</p><p><strong>Question 7</strong> asks for the administrator of the blog. Clicking on the <strong>A cheers to our IT department</strong> post presents you with a poem as shown below.</p><p><img src=/assets/img/Anthem4.png alt="Anthem website author"></p><p>Searching this poem on Google gives you the author of the poem, who is the administrator.</p><p><strong>Question 8</strong> asks you for the administrator&rsquo;s email address. On the first post on the blog, there is an email address present, <strong><a href=mailto:jd@anthem.com>jd@anthem.com</a></strong>. It appears that the email addresses are the employee&rsquo;s initials. The answer to this question is the initials of the administrator uncovered in <strong>Question 7</strong> followed by <strong>@anthem.com</strong>.</p><p><img src=/assets/img/Anthem5.png alt="Anthem email format"></p><h3 id=task-2>Task 2
<a class=heading-link href=#task-2><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Task 2 asks for help spotting flags. Let&rsquo;s see what we can uncover. Question 1 provides a hint asking if we have inspected any of the pages yet. Let&rsquo;s inspect each of the pages, starting with the main home page.</p><p>Near the top in the <strong>meta content</strong> section is the <strong>1st Flag</strong>.</p><p><img src=/assets/img/Anthem6.png alt="Anthem flag1"></p><p>Further down on the source of this page is the <strong>2nd Flag</strong>.</p><p><img src=/assets/img/Anthem7.png alt="Anthem flag2"></p><p>The <strong>3rd Flag</strong> gives a hint of Profile. You are able to click on <strong>Jane Doe</strong> on the bottom of the first post (We are hiring), which takes you to her profile page, which contains the flag.</p><p><img src=/assets/img/Anthem8.png alt="Anthem flag3"></p><p>The <strong>4th Flag</strong> asks if you have enumerated all of the pages. There are only a few present on this site, so let&rsquo;s look at each of them. The 2nd post (A cheers to our IT department) meta tags contain this flag.</p><p><img src=/assets/img/Anthem9.png alt="Anthem flag4"></p><h3 id=task-3>Task 3
<a class=heading-link href=#task-3><i class="fa fa-link" aria-hidden=true></i></a></h3><p>The <strong>1st Question</strong> here does not ask you to answer a question, but asks that you log into the box using the info you have gathered. While reviewing the above questions, I attempted to use the username uncovered for the administrator&rsquo;s email address along with the password in the robots.txt file. I was able to successfully login with these credentials. I logged in with <a href=https://remmina.org/><strong>Remmina</strong></a> using the IP of the box along with these uncovered credentials.</p><p><img src=/assets/img/Anthem10.png alt="Anthem Remote Desktop"></p><p>The <strong>2nd Question</strong> wants you to get the contents of the user.txt file on the desktop.</p><p><img src=/assets/img/Anthem11.png alt="Anthem user.txt"></p><p>The <strong>3rd Question</strong> wants you to find a hidden file based on the hint. Let&rsquo;s open file explorer and enable viewing hidden items.</p><p><img src=/assets/img/Anthem12.png alt="Anthem show hidden files"></p><p>Now, navigate to the root of C:, and there is a hidden folder called <strong>backups</strong>.</p><p><img src=/assets/img/Anthem13.png alt="Anthem hidden folder"></p><p>Inside that folder is a file named <strong>restore.txt</strong>, but we are not able to open it.</p><p><img src=/assets/img/Anthem14.png alt="Anthem restore.txt unable to open"></p><p>Let&rsquo;s right click on this file and select <strong>Properties</strong>. From here, select <strong>Security</strong> and then click on <strong>Edit</strong>. Next, click on <strong>Add&mldr;</strong> and the below box should pop up. Type in username you are logged in as and press <strong>Check Names</strong>. Press <strong>OK</strong> once the name has been checked.</p><p><img src=/assets/img/Anthem15.png alt="Anthem file permissions1"></p><p>Next select <strong>Full Control</strong> and then click on <strong>OK</strong>.</p><p><img src=/assets/img/Anthem16.png alt="Anthem file permissions2"></p><p>Click the <strong>X</strong> in the upper right hand corner of the <strong>Properties</strong> screen and then double click on <strong>restore.txt</strong> to open the file. There is a phrase in here which is potentially the administrator password.</p><p><img src=/assets/img/Anthem17.png alt="Anthem restore.txt password"></p><p>Let&rsquo;s log off and connect as <strong>Administrator</strong> via RDP with Remmina with the password you just uncovered. On the desktop is <strong>root.txt</strong>. Open the file to get your final flag (<strong>Question 4</strong>) for this challenge.</p><p><img src=/assets/img/Anthem18.png alt="Anthem root.txt"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2022
Kiel Vaughn</section></footer></main><script src=/js/coder.min.1e7ed4c0db4e8708b345265f5fcd5fbbd6753672f2f79f33c5dacbd22f524208.js integrity="sha256-Hn7UwNtOhwizRSZfX81fu9Z1NnLy958zxdrL0i9SQgg="></script></body></html>