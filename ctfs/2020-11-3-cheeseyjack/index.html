<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="CheeseyJack is a vulnerable system found on VulnHub. Below are the steps I utilized to compromise this vulnerable box.
First, after importing the machine, I ran netdiscover -i eth0 to discover the IP address of the host.
Next, I ran threader3000 with the IP address of the CheeseyJack machine to enumerate open ports.
Next, I let it run it&rsquo;s recommended nmap scan to find out more details about the open ports."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="CheeseyJack"><meta name=twitter:description content="CheeseyJack is a vulnerable system found on VulnHub. Below are the steps I utilized to compromise this vulnerable box.
First, after importing the machine, I ran netdiscover -i eth0 to discover the IP address of the host.
Next, I ran threader3000 with the IP address of the CheeseyJack machine to enumerate open ports.
Next, I let it run it&rsquo;s recommended nmap scan to find out more details about the open ports."><meta property="og:title" content="CheeseyJack"><meta property="og:description" content="CheeseyJack is a vulnerable system found on VulnHub. Below are the steps I utilized to compromise this vulnerable box.
First, after importing the machine, I ran netdiscover -i eth0 to discover the IP address of the host.
Next, I ran threader3000 with the IP address of the CheeseyJack machine to enumerate open ports.
Next, I let it run it&rsquo;s recommended nmap scan to find out more details about the open ports."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-11-3-cheeseyjack/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-11-03T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-03T00:00:00+00:00"><title>CheeseyJack · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-11-3-cheeseyjack/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.216fdd344aee259067eaade5e8108697c18f6d1e6d5d9ec7e1269f4cf0d39d56.css integrity="sha256-IW/dNEruJZBn6q3l6BCGl8GPbR5tXZ7H4SafTPDTnVY=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.111.1"></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-11-3-cheeseyjack/>CheeseyJack</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-11-03T00:00:00Z>November 3, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/privilege-escalation/>privilege escalation</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/qdpm-exploitation/>QDPM exploitation</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/insecure-passwords/>insecure passwords</a></span></div></div></header><div><p><a href=https://www.vulnhub.com/entry/cheesey-cheeseyjack,578/>CheeseyJack</a> is a vulnerable system found on VulnHub. Below are the steps I utilized to compromise this vulnerable box.</p><p>First, after importing the machine, I ran <strong>netdiscover -i eth0</strong> to discover the IP address of the host.</p><p><img src=/assets/img/CheeseyJack1.png alt="CheeseyJack netdiscover"></p><p>Next, I ran <strong>threader3000</strong> with the IP address of the CheeseyJack machine to enumerate open ports.</p><p><img src=/assets/img/CheeseyJack2.png alt="CheeseyJack threader3000"></p><p>Next, I let it run it&rsquo;s recommended <strong>nmap</strong> scan to find out more details about the open ports.</p><p><img src=/assets/img/CheeseyJack3.png alt="CheeseyJack nmap 1"></p><p><img src=/assets/img/CheeseyJack4.png alt="CheeseyJack nmap 2"></p><p>It looks like several services are running including OpenSSH, Apache, and rpc. Let&rsquo;s first take a look at the website to see if anything interesting can be uncovered.</p><p><img src=/assets/img/CheeseyJack5.png alt="CheeseyJack website"></p><p>The initial website doesn&rsquo;t have anything glaringly obvious on it, so let&rsquo;s utilize <strong>gobuster dir -u http://[victim ip] -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20</strong> to enumerate the website for potential interesting information. A few directories are uncovered as shown below.</p><p><img src=/assets/img/CheeseyJack6.png alt="CheeseyJack gobuster"></p><p>Let&rsquo;s take a look at the <strong>/it_security</strong> directory, this directory&rsquo;s contents are listed, and there is a file named <strong>note.txt</strong> which has the following information in it.</p><p><img src=/assets/img/CheeseyJack7.png alt="CheeseyJack it_security note.txt"></p><p>This appears to tell us that someone named <strong>Cheese</strong> has a very poor password for the webapp project. Let&rsquo;s take a look at the <strong>/project_management</strong> directory next.</p><p><img src=/assets/img/CheeseyJack8.png alt="CheeseyJack project_management"></p><p>This page provides us with a login, which is requesting an email address. I tried <a href=mailto:cheese@cheeseyjack.local>cheese@cheeseyjack.local</a> with a few easy to guess passwords, but was not able to get in. I did make note that this is running <strong>qdPM 9.1</strong>. Next, I ran <strong>gobuster dir -u http://[victim ip]/project_management -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20</strong>.</p><p><img src=/assets/img/CheeseyJack9.png alt="CheeseyJack gobuster project_management"></p><p>This uncovers several potentially interesting directories. After looking around, there was a <strong>databases.yml</strong> file uncovered in the <strong>/project_management/core/config</strong> directory that contains user credentials. I made note of these credentials for potential use elsewhere.</p><p><img src=/assets/img/CheeseyJack10.png alt="CheeseyJack project_management subdirectory enumeration"></p><p>Next, I ran <strong>enum4linux [victim ip]</strong> to see if I could uncover anything interesting.</p><p><img src=/assets/img/CheeseyJack11.png alt="CheeseyJack enum4linux"></p><p>I was able to uncover 2 usernames: <strong>ch33s3m4n</strong> and <strong>crab</strong>. I made note of these as these could potentially be used in email addresses to login to the <strong>/project_management</strong> subdirectory containing <strong>qdPM</strong>.</p><p><img src=/assets/img/CheeseyJack12.png alt="CheeseyJack qdpm login"><a href=/assets/img/></a></p><p>I tried <strong><a href=mailto:ch33s3m4n@cheeseyjack.local>ch33s3m4n@cheeseyjack.local</a></strong> and after several attempts, was able to get logged in with the password of <strong>qdpm</strong> (the note.txt file earlier helped figure this out pretty quickly).</p><p><img src=/assets/img/CheeseyJack13.png alt="CheeseyJack qdpm login"></p><p>I was not able to find a way to upload a reverse shell, so I ran <strong>searchsploit qdpm</strong> and was able to uncover a few exploits. The one I decided to utilize was named <strong>qdPM &lt; 9.1 - Remote Code Execution</strong>. I then ran <strong>searchsploit -m 48146</strong> to copy the script to my local directory.</p><p><img src=/assets/img/CheeseyJack14.png alt="CheeseyJack searchsploit"></p><p>Next, I opened this exploit in a text editor to modify the information outlined below.</p><p><img src=/assets/img/CheeseyJack15.png alt="CheeseyJack update RCE exploit"></p><p>The payload I used was <a href=http://pentestmonkey.net/tools/web-shells/php-reverse-shell>PenTestMonkey&rsquo;s</a> reverse PHP shell. Next, once saved, I opened a 2nd terminal window and ran <strong>nc -nvlp 8080</strong> to open a netcat listener for this exploit to connect to.</p><p><img src=/assets/img/CheeseyJack16.png alt="CheeseyJack nc listener"></p><p>Next, I went back to the original terminal window to run this exploit with <strong>python3 ./48146.py</strong>.</p><p><img src=/assets/img/CheeseyJack17.png alt="CheeseyJack run exploit"></p><p>This will cause an error, but if you go back to your netcat listener, you should have a shell.</p><p><img src=/assets/img/CheeseyJack18.png alt="CheeseyJack reverse shell"></p><p>Let&rsquo;s do some basic enumeration and see what info we can find. First, let&rsquo;s navigate to <strong>cd /home</strong> and run <strong>ls -al</strong> to enumerate the home directories. Not surprising, two show up, <strong>ch33s3m4n</strong> and <strong>crab</strong>. I didn&rsquo;t find anything of interest in ch33s3m4n&rsquo;s directory, but I did find a <strong>todo.txt</strong> file in <strong>/home/crab</strong>. I then ran <strong>cat todo.txt</strong> which contained some interesting information in it.</p><p><img src=/assets/img/CheeseyJack19.png alt="CheeseyJack todo.txt"></p><p>Next, I ran <strong>cd /var/backups</strong> and ran <strong>ls -al</strong> to enumerate this directory&rsquo;s contents. There was a subdirectory named <strong>ssh-bak</strong> in this directory. I navigated to this folder with <strong>cd ssh-bak</strong> and ran <strong>ls -al</strong>, which shows what appears to be a backup copy of an SSH key.</p><p><img src=/assets/img/CheeseyJack20.png alt="CheeseyJack ssh-bak"></p><p>Next, I ran <strong>cat key.bak</strong> and copied the contents into a text file which I saved as <strong>ssh_key.txt</strong>.</p><p><img src=/assets/img/CheeseyJack21.png alt="CheeseyJack SSH key"></p><p>Next, I opened another terminal window and ran <strong>chmod 600 ssh_key.txt</strong> (as SSH requires these permissions to connect) followed by <strong>ssh -i ssh_key.txt crab@[victim ip]</strong>.</p><p><img src=/assets/img/CheeseyJack22.png alt="CheeseyJack SSH crab user"></p><p>We were now connected as the <strong>crab</strong> user to this host.</p><p><img src=/assets/img/CheeseyJack23.png alt="CheeseyJack privilege escalation"></p><p>I next ran <strong>sudo -l</strong> to enumerate permissions for this user. It appears that this user can run anything as sudo in the <strong>/home/crab/.bin/</strong> directory, which makes privilege escalation easily attainable. I ran <strong>cp /bin/bash /home/crab/.bin/bash</strong> to copy over the bash shell to this folder, followed by by <strong>sudo /home/crab/.bin/bash -p</strong> to run bash in a privileged mode, this provided me with root access which was verified with <strong>whoami</strong>.</p><p><img src=/assets/img/CheeseyJack24.png alt="CheeseyJack root.txt"></p><p>Finally, I navigate to the root directory with <strong>cd /root</strong> and ran <strong>ls -al</strong>, there was a <strong>root.txt</strong> file present. Running <strong>cat root.txt</strong> provided the information in the screenshot above, finishing up this box!</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>